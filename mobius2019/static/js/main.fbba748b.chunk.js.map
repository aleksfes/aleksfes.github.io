{"version":3,"sources":["redux/create-reducer.ts","redux/create-do-actions.ts","redux/full-screen/full-screen-state.ts","app/route-states.ts","redux/full-screen/full-screen-reducer.ts","redux/routing/routing-state.ts","redux/routing/routing-reducer.ts","utils/storage.ts","redux/questions/questions-state.ts","utils/extend-state.ts","redux/questions/questions-reducer.ts","utils/file.ts","redux/users/users-state.ts","redux/users/users-reducer.ts","redux/do-actions.ts","app/index.ts","app/app.ts","components/AppHeader/AppHeader.tsx","components/Landing/Landing.tsx","utils/text.ts","components/FileExport/FileExport.tsx","components/FileImport/FileImport.tsx","components/AdminMenu/AdminMenu.tsx","models/placeholders.ts","components/QuestionEdit/QuestionEdit.tsx","utils/clone-question.ts","components/QuestionsManagement/QuestionsManagement.tsx","components/RegistrationForm/RegistrationForm.tsx","utils/get-new-user.ts","components/Quest/Quest.tsx","components/Routing/Routing.tsx","components/App/App.tsx","redux/root-reducer.ts","redux/state.ts","index.tsx","redux/store.ts"],"names":["createReducer","reducerObj","initialState","state","action","actionType","type","reducer","createDoActions","_len","arguments","length","actionsNamesList","Array","_key","reduce","memo","actionName","store","payload","dispatch","ROUTE_STATES","fullScreenInitialState","inFullscreen","fullScreenActions","fullScreenReducer","TOGGLE","routeInitialState","route","MAIN","routingActions","routingReducer","GO_TO","StorageValue","key","undefined","Object","classCallCheck","this","value","serializedValue","JSON","stringify","window","localStorage","setItem","defaultValue","defaultValueToUse","getItem","parse","e","console","error","concat","storage","questions","users","adminPass","questionsInitialState","restore","currentQuestionId","extendState","toAddOrKey","toAdd","defineProperty","objectSpread","FILE_TYPES","questionsActions","questionsReducer","ADD","question","id","toConsumableArray","DELETE","questionToDelete","map","UPDATE","questionToUpdate","resetIsFirst","isFirst","GO_TO_QUESTION","REPLACE","usersInitialState","currentUser","registrationUser","usersActions","usersReducer","CLEAR_REG_USER","REG_USER","ADD_OR_UPDATE","rawUser","newUser","keys","userKey","newValue","trim","sameUserIndex","findIndex","user","phone","hasSameUser","newUsersList","push","doActions","fullScreen","routing","app","App","_store","storeUnsubscriber","storedQuestions","storedUsers","createClass","_this","unsubscribeStore","subscribe","getState","storeQuestions","storeUsers","QUEST","questionId","lastQuestionId","qs","storedAdminPassHash","prompt","adminPassHash","md5","alert","goToRoute","ADMIN_MAIN","stateQuestions","stateUsers","get","sf","AppHeaderComponent","toggleState","toggleFullscreen","_this2","_this$props","props","className","isFullScreen","mainRouteState","conditionalClasses","AppHeader_small","react_default","a","createElement","classnames","onClick","toggleFullScreen","on","off","_this3","toggle","catch","log","React","Component","AppHeader","connect","Landing","restartGame","goToAdmin","padStart","item","strLength","symbol","mimeTypes","CSV","getFileObject","params","releaseFileObject","fileObjectUrl","charset","mimeType","fileType","data","Blob","content","URL","createObjectURL","revokeObjectURL","getFileName","section","extension","timestamp","now","Date","y","getFullYear","m","getMonth","d","getDate","H","getHours","M","getMinutes","S","getSeconds","getTimestamp","FileExport","fileName","buttonText","_this$state","prepareFile","href","download","releaseStateFileObject","fileDescription","getFileDescription","setState","stringifyContent","nameSection","toLowerCase","FileImport","onChange","event","onFileSelected","files","target","file","Promise","resolve","reject","reader","FileReader","onload","result","onerror","readAsText","readFileAsString","then","_this3$props","parseJson","onContentRead","name","AdminMenu","_ref","ADMIN_QUESTIONS_LIST","FileImport_FileImport","updateQuestions","FileExport_FileExport","placeholdersInfo","<%reg%>","<%login%>","QuestionEdit","_React$Component","_getPrototypeOf2","args","possibleConstructorReturn","getPrototypeOf","call","apply","isNew","hideTextError","inherits","hasAnswers","answers","filter","Boolean","isFinal","tooManyReg","text","split","mainHtmlId","textHtmlId","isFirstHtmlId","randomTextHtmlId","rootId","getRootId","react","onSubmit","checked","updateQuestionProp","htmlFor","placeholder","randomLineText","answerOrNull","index","answer","answerHtmlId","answerGotoHtmlId","answerInputHtmlId","answerWrongInputGotoHtmlId","answerRandomLineHtmlId","updateAnswerProp","deleteAnswer","randomLine","needUserInput","incorrectUserInputNextQuestion","parseInt","nextQuestion","addAnswer","onDelete","propName","propValue","originalAnswer","updatedAnswer","preventDefault","onSave","answerIndex","stateAnswers","newAnswer","propQuestion","stateQuestion","QuestionsManagement","QuestionEdit_QuestionEdit_QuestionEdit","addQuestion","updateQuestion","deleteQuestion","RegistrationFormComponent","firstName","lastName","login","mainId","firstNameId","lastNameId","phoneId","loginId","maxLength","updateUser","userProp","registerUser","RegistrationForm","QuestComponent","userInput","currentQuestion","regUser","hideAnswers","includes","renderQuestionText","renderAnswer","handleSelectedAnswer","texts","Math","floor","random","replaceLogin","expectedValue","textParts","RegistrationForm_RegistrationForm","join","Quest","Routing","Quest_Quest","QuestionsManagement_QuestionsManagement","AdminMenu_AdminMenu","Landing_Landing","_header_small","_quest-in-progress","AppHeader_AppHeader","rootReducer","combineReducers","createStore","setStore","appElement","es","App_App_App","document","title","ReactDOM","render","getElementById"],"mappings":"yeAUO,SAASA,EACPC,EAAoDC,GAEzD,OAAO,SAACC,EAA2BC,GAC/B,IAAKD,EACD,OAAOD,EAGX,IAAMG,EAAsCD,EAAOE,KAC7CC,EAAWN,EAAmBI,GACpC,OAAIE,EACOA,EAAQJ,EAAQC,GAEpBD,GCfR,SAASK,IAAkI,QAAAC,EAAAC,UAAAC,OAA5FC,EAA4F,IAAAC,MAAAJ,GAAAK,EAAA,EAAAA,EAAAL,EAAAK,IAA5FF,EAA4FE,GAAAJ,UAAAI,GAC9I,OAAOF,EAAiBG,OAAO,SAACC,EAAMC,GAWlC,OAVAD,EAAKC,GAAc,SAACC,EAAOC,GAClBD,GAILA,EAAME,SAAS,CACXd,KAAMW,EACNE,aAGDH,GACR,IChBA,ICLKK,EDKCC,EAA2C,CACpDC,cAAc,GEILC,EAAoBhB,EAA8C,UAUlEiB,EAAoBzB,EAP+C,CAC5E0B,OAAU,SAACvB,GAAD,MAAY,CAClBoB,cAAepB,EAAOoB,gBAK6BD,aDpB/CD,qHEQL,IAAMM,EAAmC,CAC5CC,MAAOP,EAAaQ,MCEXC,EAAiBtB,EAA2C,SAU5DuB,EAAiB/B,EAP4C,CACtEgC,MAAS,SAAC7B,EAAOC,GAAR,MAAoB,CACzBwB,MAAOxB,EAAOe,WAKkCQ,WCjBlDM,aAEF,SAAAA,IAA8B,IAAVC,EAAUxB,UAAAC,OAAA,QAAAwB,IAAAzB,UAAA,GAAAA,UAAA,GAAJ,GAAI0B,OAAAC,EAAA,EAAAD,CAAAE,KAAAL,GAAAK,KAAAJ,wDAIxBK,GACF,IAAMC,EAAkBC,KAAKC,UAAUH,GACvCI,OAAOC,aAAaC,QAAQP,KAAKJ,IAAKM,mCAIlCM,GACJ,IAAMC,EAAoBD,GAAgB,KACpCN,EAAkBG,OAAOC,aAAaI,QAAQV,KAAKJ,KACzD,IAAKM,EACD,OAAOO,EAEX,IACI,OAAON,KAAKQ,MAAMT,GACpB,MAAOU,GACLC,QAAQC,MAAM,mBAAoBZ,GAClCW,QAAQC,MAAR,2CAAAC,OAAyDf,KAAKJ,KAAOgB,GAEzE,OAAOH,WAKFO,EAAU,CACnBC,UAAW,IAAItB,EAA6B,wBAC5CuB,MAAO,IAAIvB,EAAsB,oBACjCwB,UAAW,IAAIxB,EAAqB,yBC1B3ByB,EAAyC,CAClDH,UAAWD,EAAQC,UAAUI,QAAQ,IACrCC,kBAAmB,UCThB,SAASC,EAAkC1D,EAAU2D,EAA4BvB,GACpF,IAAMwB,EAA6B,IAArBrD,UAAUC,OAAVyB,OAAA4B,EAAA,EAAA5B,CAAA,GACJ0B,EAAkBvB,GACtBuB,EACN,OAAO1B,OAAA6B,EAAA,EAAA7B,CAAA,GACAjC,EACA4D,GCOJ,ICdKG,EDcCC,EAAmB3D,EAC5B,MAAO,SAAU,SAAU,UAAW,kBAyC7B4D,EAAmBpE,EArC8C,CAC1EqE,IAAO,SAAClE,EAAOC,GAEX,IAAMkE,EAAQlC,OAAA6B,EAAA,EAAA7B,CAAA,GAAQhC,EAAOe,SACvBoC,EAAYpD,EAAOoD,UAEzB,OADAe,EAASC,GAAKhB,EAAU5C,OAAS,EAC1BkD,EAAY1D,EAAQ,YAAT,GAAAkD,OAAAjB,OAAAoC,EAAA,EAAApC,CAA0BmB,GAA1B,CAAqCe,MAE3DG,OAAU,SAACtE,EAAOC,GACd,IAAMsE,EAAmBtE,EAAOe,QAC1BoC,EAAYpD,EAAOoD,UAAUoB,IAAI,SAAAL,GAAQ,OAC3CA,GAAYA,EAASC,KAAOG,EAAiBH,GAAKD,EAAW,OACjE,OAAOT,EAAY1D,EAAQ,YAAaoD,IAE5CqB,OAAU,SAACzE,EAAOC,GACd,IAAMyE,EAAmBzE,EAAOe,QAC1B2D,EAAeD,EAAiBE,QAChCxB,EAAYpD,EAAOoD,UAAUoB,IAAI,SAAAL,GACnC,OAAKA,GAGDQ,IACAR,EAAQlC,OAAA6B,EAAA,EAAA7B,CAAA,GAAQkC,EAAR,CAAkBS,SAAS,KAEhCT,EAASC,KAAOM,EAAiBN,GAAKM,EAAmBP,GALrD,OAOf,OAAOT,EAAY1D,EAAQ,YAAaoD,IAE5CyB,eAAkB,SAAC7E,EAAOC,GACtB,OAAOyD,EAAY1D,EAAQ,oBAAqBC,EAAOe,UAE3D8D,QAAW,SAAC9E,EAAOC,GACf,OAAOyD,EAAY1D,EAAQ,YAAaC,EAAOe,WAKGuC,GE/C7CwB,EAAiC,CAC1C1B,MAAOF,EAAQE,MAAMG,QAAQ,IAC7BwB,YAAa,KACbC,iBAAkB,MCATC,EAAe7E,EAAyC,gBAAiB,WAAY,kBA4BrF8E,EAAetF,EAzB0C,CAClEuF,eAAkB,SAACpF,GAAD,OAAW0D,EAAY1D,EAAQ,mBAAoB,OACrEqF,SAAY,SAACrF,EAAOC,GAAR,OAAmByD,EAAY1D,EAAQ,mBAAoBC,EAAOe,UAC9EsE,cAAiB,SAACtF,EAAOC,GACrB,IAAMsF,EAAUtF,EAAOe,QACjBwE,EAAUvD,OAAOwD,KAAKF,GAAS3E,OAAc,SAACC,EAAMkB,GACtD,IAAM2D,EAAU3D,EACV4D,EAAWJ,EAAQG,GAEzB,OADA7E,EAAK6E,GAA+B,kBAAbC,EAAwBA,EAASC,OAASD,EAC1D9E,GACR,IACGgF,EAAgB7F,EAAOqD,MAAMyC,UAAU,SAAAC,GAAI,OAAIA,EAAKC,QAAUR,EAAQQ,QACtEC,GAAiC,IAAnBJ,EAChBK,EAAYjE,OAAAoC,EAAA,EAAApC,CAAOjC,EAAOqD,OAO9B,OANI4C,EACAC,EAAaL,GAAiBL,EAE9BU,EAAaC,KAAKX,GAEtB9B,EAAY1D,EAAQ,cAAewF,GAC5B9B,EAAY1D,EAAQ,QAASkG,KAKUnB,GCpCzCqB,EAAY,CACrBC,WAAYhF,EACZiF,QAAS3E,EACTyB,UAAWY,EACXX,MAAO6B,oBCREqB,EAAM,ICSnB,oBAAAC,IAAAvE,OAAAC,EAAA,EAAAD,CAAAE,KAAAqE,GAAArE,KAEYsE,OAA2B,KAFvCtE,KAIYuE,kBAAwC,KAJpDvE,KAMYwE,gBAAkC,GAN9CxE,KAOYyE,YAAuB,GAPnCzE,KAcIjB,aAAeA,EAdnB,OAAAe,OAAA4E,EAAA,EAAA5E,CAAAuE,EAAA,EAAAzE,IAAA,WAAAK,MAAA,SAiBarB,GAAkB,IAAA+F,EAAA3E,KACvBA,KAAKsE,OAAS1F,EACdoB,KAAK4E,mBACDhG,GACAA,EAAMiG,UAAU,WACZ,IAAMhH,EAAQe,EAAMkG,WACpBH,EAAKI,eAAelH,GACpB8G,EAAKK,WAAWnH,OAxBhC,CAAA+B,IAAA,cAAAK,MAAA,WA+BQgE,EAAU/C,MAAM+B,eAAejD,KAAKsE,QACpCL,EAAUhD,UAAUyB,eAAe1C,KAAKsE,OAAQ,GAChDL,EAAUE,QAAQzE,MAAMM,KAAKsE,OAAQvF,EAAakG,SAjC1D,CAAArF,IAAA,mBAAAK,MAAA,WAsCQgE,EAAUC,WAAW9E,OAAOY,KAAKsE,UAtCzC,CAAA1E,IAAA,YAAAK,MAAA,SA0CcX,GACN2E,EAAUE,QAAQzE,MAAMM,KAAKsE,OAAQhF,KA3C7C,CAAAM,IAAA,cAAAK,MAAA,SA+CgB+B,GACRiC,EAAUhD,UAAUc,IAAI/B,KAAKsE,OAAQtC,KAhD7C,CAAApC,IAAA,iBAAAK,MAAA,SAoDmB+B,GACXiC,EAAUhD,UAAUkB,OAAOnC,KAAKsE,OAAQtC,KArDhD,CAAApC,IAAA,iBAAAK,MAAA,SAyDmB+B,GACXiC,EAAUhD,UAAUqB,OAAOtC,KAAKsE,OAAQtC,KA1DhD,CAAApC,IAAA,eAAAK,MAAA,SA8DiBiF,GACTjB,EAAUhD,UAAUyB,eAAe1C,KAAKsE,OAAQY,GAChD,IAAMpC,EAAmB9C,KAAKnC,MAAMqD,MAAM4B,iBACtCA,GACAmB,EAAU/C,MAAMiC,cAAcnD,KAAKsE,OAAnCxE,OAAA6B,EAAA,EAAA7B,CAAA,GACOgD,EADP,CAEIqC,eAAgBD,OApEhC,CAAAtF,IAAA,kBAAAK,MAAA,SAyEoBgB,GACZ,IAAMmE,EAAKnE,aAAqB1C,MAAQ0C,EAAaA,EAAiCA,UACtFgD,EAAUhD,UAAU0B,QAAQ3C,KAAKsE,OAAQc,KA3EjD,CAAAxF,IAAA,eAAAK,MAAA,SA+EiB2D,GACTK,EAAU/C,MAAMgC,SAASlD,KAAKsE,OAAQV,KAhF9C,CAAAhE,IAAA,YAAAK,MAAA,WAqFQ,IAAMoF,EAAsBrE,EAAQG,UAAUE,UACxCF,EAAYmE,OAAO,2SAA4D,IAErF,GAAKnE,EAAL,CAKA,IAAMoE,EAAgBC,IAAIrE,GAE1B,GAAIkE,GACA,GAAIA,IAAwBE,EAExB,YADAE,MAAM,8HAIVzE,EAAQG,UAAUvC,MAAM2G,GACxBE,MAAM,0FAGVzF,KAAK0F,UAAU3G,EAAa4G,iBAhBxBF,MAAM,oGAzFlB,CAAA7F,IAAA,mBAAAK,MAAA,WA8GYD,KAAKuE,oBACLvE,KAAKuE,oBACLvE,KAAKuE,kBAAoB,QAhHrC,CAAA3E,IAAA,iBAAAK,MAAA,SAqH2BpC,GACnB,IAAM+H,EAAiB/H,EAAMoD,UAAUA,UACnC2E,IAAmB5F,KAAKwE,kBACxBxE,KAAKwE,gBAAkBoB,EACvB5E,EAAQC,UAAUrC,MAAMgH,MAzHpC,CAAAhG,IAAA,aAAAK,MAAA,SA8HuBpC,GACf,IAAMgI,EAAahI,EAAMqD,MAAMA,MAC3B2E,IAAe7F,KAAKyE,cACpBzE,KAAKyE,YAAcoB,EACnB7E,EAAQE,MAAMtC,MAAMiH,MAlIhC,CAAAjG,IAAA,QAAAkG,IAAA,WAUQ,OAAO9F,KAAKsE,OAAQQ,eAV5BT,EAAA,ICDI0B,QAgBEC,6MAEFC,YAAc,kBAAM7B,EAAI8B,4FAGf,IAAAC,EAAAnG,KAAAoG,EACsCpG,KAAKqG,MAAxCC,EADHF,EACGE,UAAWC,EADdH,EACcG,aACbC,EAFDJ,EAC4B9G,QACAP,EAAaQ,KACxCkH,EAAqB,CACvBC,iBAAoBF,GAGxB,OACIG,EAAAC,EAAAC,cAAA,OAAKP,UAAWQ,IAAW,YAAaR,EAAWG,KAC5CF,GAAgBC,GACfG,EAAAC,EAAAC,cAAA,UAAQ7I,KAAK,SAAS+I,QAAS,kBAAMZ,EAAKa,oBAAoBV,UAAU,yBAAxE,iEAIDE,GACCG,EAAAC,EAAAC,cAAA,UAAQ7I,KAAK,SAAS+I,QAAS,kBAAM3C,EAAIsB,UAAUtB,EAAIrF,aAAaQ,QAApE,wGAUZwG,EAAGkB,GAAG,SAAUjH,KAAKiG,4DAKrBF,EAAGmB,IAAI,SAAUlH,KAAKiG,wDAIP,IAAAkB,EAAAnH,KACf+F,EAAGqB,SACEC,MAAM,SAAAvG,GAAK,OAAID,QAAQyG,IAAR,oDAAAvG,OACwCoG,EAAKd,MAAME,cAC/DzF,YA3CiByG,IAAMC,WAkD1BC,EAAYC,YAxDkD,SAAC7J,GAAD,MAAY,CACnFyB,MAAOzB,EAAMsG,QAAQ7E,MACrBiH,aAAc1I,EAAMqG,WAAWjF,eAsDVyI,CAAyB1B,GCjDrC2B,SAlBqC,WAC9C,OACIhB,EAAAC,EAAAC,cAAA,WACIF,EAAAC,EAAAC,cAAA,WACIF,EAAAC,EAAAC,cAAA,UAAQ7I,KAAK,SAAS+I,QAAS,kBAAM3C,EAAIwD,gBAAzC,yCAIJjB,EAAAC,EAAAC,cAAA,OAAKP,UAAU,sBACXK,EAAAC,EAAAC,cAAA,UAAQ7I,KAAK,SAAS+I,QAAS,kBAAM3C,EAAIyD,cAAzC,0HCdT,SAASC,EAASC,EAAqBC,EAAmBC,GAE7D,OADgB,GAAKF,GACND,SAASE,EAAWC,aRJ3BrG,yCAMZ,IAAMsG,EAA6C,CAC/C/H,KAAM,mBACNgI,IAAK,YAqBF,SAASC,EAAcC,GAM5BC,EAAkBD,EAAOE,eAEzB,IAAMC,EAAUH,EAAOG,SAAW,QAC5BC,EAAWP,EAAUG,EAAOK,UAC5B1K,EAAI,QAAA+C,OAAW0H,EAAX,aAAA1H,OAA+ByH,GACnCG,EAAO,IAAIC,KAAK,CAACP,EAAOQ,SAAU,CAAE7K,SAE1C,OADmBqC,OAAOyI,IAAIC,gBAAgBJ,GAOzC,SAASL,EAAkBC,GAC5BA,GAGFlI,OAAOyI,IAAIE,gBAAgBT,GA0DxB,SAASU,EAAYC,EAAiBC,GACzC,IAAMC,EAbV,WACI,IAAMC,EAAM,IAAIC,KACVC,EAAIF,EAAIG,cACRC,EAAI3B,EAASuB,EAAIK,WAAa,EAAG,EAAG,KACpCC,EAAI7B,EAASuB,EAAIO,UAAW,EAAG,KAC/BC,EAAI/B,EAASuB,EAAIS,WAAY,EAAG,KAChCC,EAAIjC,EAASuB,EAAIW,aAAc,EAAG,KAClCC,EAAInC,EAASuB,EAAIa,aAAc,EAAG,KACxC,SAAAnJ,OAAUwI,EAAV,KAAAxI,OAAe0I,EAAf,KAAA1I,OAAoB4I,EAApB,MAAA5I,OAA0B8I,EAA1B,KAAA9I,OAA+BgJ,EAA/B,KAAAhJ,OAAoCkJ,GAKlBE,GAIlB,OAHiBhB,EAAS,GAAApI,OACjBmI,EADiB,KAAAnI,OACNqI,EADM,KAAArI,OACOoI,GADP,GAAApI,OAEjBqI,EAFiB,KAAArI,OAEJmI,OShCbkB,6MAjETvM,MAA0B,CACtB0K,cAAe,GACf8B,SAAU,4EAGL,IAAAlE,EAAAnG,KACGsK,EAAetK,KAAKqG,MAApBiE,WADHC,EAE+BvK,KAAKnC,MAAjC0K,EAFHgC,EAEGhC,cAAe8B,EAFlBE,EAEkBF,SAEvB,OACI1D,EAAAC,EAAAC,cAAA,WACIF,EAAAC,EAAAC,cAAA,UAAQ7I,KAAK,SACT+I,QAAS,kBAAMZ,EAAKqE,eACpBlE,UAAU,sBAERgE,GAEJ/B,GACE5B,EAAAC,EAAAC,cAAA,KAAG4D,KAAMlC,EAAemC,SAAUL,EAC9B/D,UAAU,sBADd,8GAYZtG,KAAK2K,yBAEL,IAAMC,EAAkB5K,KAAKqG,MAAMwE,qBACnC7K,KAAK8K,SAAS,CACVvC,cAAeH,EAAc,CACzBS,QAAS7I,KAAK+K,iBAAiBH,EAAgB/B,SAC/CH,SAAUkC,EAAgB5M,OAE9BqM,SAAUpB,EAAY2B,EAAgBI,YAAapJ,EAAWgJ,EAAgB5M,MAAMiN,kEAK3D,IACrB1C,EAAkBvI,KAAKnC,MAAvB0K,cACJA,GACAD,EAAkBC,4CAKDM,GACrB,OAAKA,EAGkB,kBAAZA,EAEA1I,KAAKC,UAAUyI,EAAS,KAAM,GAElC1I,KAAKC,UAAUyI,GANX,UAvDetB,IAAMC,WCwC3B0D,oNAvCTrN,MAA0B,2EAGjB,IAAAsI,EAAAnG,KACGsK,EAAetK,KAAKqG,MAApBiE,WACR,OACI3D,EAAAC,EAAAC,cAAA,SAAOP,UAAU,cACXgE,EACF3D,EAAAC,EAAAC,cAAA,SAAO7I,KAAK,OACRsI,UAAU,oBACV6E,SAAU,SAACC,GAAD,OAAWjF,EAAKkF,eAAeD,8CAOlCA,GAAsC,IAAAjE,EAAAnH,KACnDsL,EAAQF,EAAMG,OAAOD,MACrBE,EAAOF,GAASA,EAAM,GACxBE,GVwCL,SAA0BA,GAC7B,OAAO,IAAIC,QAAgB,SAACC,EAASC,GACjC,IAAMC,EAAS,IAAIC,WAEnBD,EAAOE,OAAS,SAACV,GACb,IAAMvC,EAAWuC,EAAMG,OAAeQ,OACtCL,EAAQ7C,IAGZ+C,EAAOI,QAAU,SAAClL,GACd6K,EAAO7K,IAGX8K,EAAOK,WAAWT,KUpDdU,CAAiBV,GACZW,KAAK,SAAAtD,GAAW,IAAAuD,EACwBjF,EAAKd,MAAlCgG,EADKD,EACLC,UAAWC,EADNF,EACME,cAEnB,IAAKD,EACD,OAAOC,EAAczD,GAIzByD,EADanM,KAAKQ,MAAMkI,MAG3BxB,MAAM,SAAAvG,GAAK,OAAID,QAAQC,MAAR,sBAAAC,OAAoCyK,EAAKe,MAAQzL,YAlC/CyG,IAAMC,YCsD3BgF,EAAY9E,YAnD+C,SAAC7J,GAAD,MAAY,CAChFoD,UAAWpD,EAAMoD,UAAUA,UAC3BC,MAAOrD,EAAMqD,MAAMA,QAiDEwG,CA7C6B,SAAA+E,GAA0B,IAAvBxL,EAAuBwL,EAAvBxL,UAAWC,EAAYuL,EAAZvL,MAChE,OACIyF,EAAAC,EAAAC,cAAA,MAAIP,UAAU,mBACVK,EAAAC,EAAAC,cAAA,UACIF,EAAAC,EAAAC,cAAA,UAAQ7I,KAAK,SAAS+I,QAAS,kBAAM3C,EAAIsB,UAAUtB,EAAIrF,aAAa2N,wBAApE,wHAIJ/F,EAAAC,EAAAC,cAAA,UACIF,EAAAC,EAAAC,cAAC8F,EAAD,CAAYrC,WAAW,gJACnB+B,WAAW,EACXC,cAAe,SAACrL,GACZmD,EAAIwI,gBAAgB3L,GACpBZ,OAAOoF,MAAM,+IAIzBkB,EAAAC,EAAAC,cAAA,UACIF,EAAAC,EAAAC,cAACgG,EAAD,CAAYvC,WAAW,wFACnBO,mBAAoB,iBAAO,CACvB7M,KAAM4D,EAAWzB,KACjB0I,QAAS,CAAE5H,aACX+J,YAAa,iBAIzBrE,EAAAC,EAAAC,cAAA,UACIF,EAAAC,EAAAC,cAACgG,EAAD,CAAYvC,WAAW,wIACnBO,mBAAoB,iBAAO,CACvB7M,KAAM4D,EAAWzB,KACjB0I,QAAS,CAAE3H,SACX8J,YAAa,aAIzBrE,EAAAC,EAAAC,cAAA,UACIF,EAAAC,EAAAC,cAAA,UAAQ7I,KAAK,SAAS+I,QAAS,kBAAM3C,EAAIsB,UAAUtB,EAAIrF,aAAaQ,QAApE,2EC3DT,IAAMuN,EAAsD,CAC/DC,UAAW,wTACXC,YAAa,2OC8BV,IAAMC,GAAb,SAAAC,GAAA,SAAAD,IAAA,IAAAE,EAAAxI,EAAA7E,OAAAC,EAAA,EAAAD,CAAAE,KAAAiN,GAAA,QAAA9O,EAAAC,UAAAC,OAAA+O,EAAA,IAAA7O,MAAAJ,GAAAK,EAAA,EAAAA,EAAAL,EAAAK,IAAA4O,EAAA5O,GAAAJ,UAAAI,GAAA,OAAAmG,EAAA7E,OAAAuN,EAAA,EAAAvN,CAAAE,MAAAmN,EAAArN,OAAAwN,EAAA,EAAAxN,CAAAmN,IAAAM,KAAAC,MAAAL,EAAA,CAAAnN,MAAAe,OAAAqM,MAEIvP,MAA4B,CACxB4P,OAAO,EACPC,eAAe,GAJvB/I,EAAA,OAAA7E,OAAA6N,EAAA,EAAA7N,CAAAmN,EAAAC,GAAApN,OAAA4E,EAAA,EAAA5E,CAAAmN,EAAA,EAAArN,IAAA,SAAAK,MAAA,WA0Ca,IAAAkG,EAAAnG,KAAAuK,EACsCvK,KAAKnC,MAAxCmE,EADHuI,EACGvI,SAAUyL,EADblD,EACakD,MAAOC,EADpBnD,EACoBmD,cADpBtH,EAEqBpG,KAAKqG,MAAvBjB,EAFHgB,EAEGhB,GAAIkB,EAFPF,EAEOE,UACNsH,EAAa5L,EAAU6L,QAAQC,OAAOC,SAAS1P,OAAS,EACxD2P,GAAWJ,EACXK,EAAajM,EAAUkM,KAAKC,MD1EG,WC0EmB9P,OAAS,EAE3D+P,EAAU,iBAAArN,OAAoBiB,EAAUC,IAExCoM,EAAU,GAAAtN,OAAMqN,EAAN,UACVE,EAAa,GAAAvN,OAAMqN,EAAN,aACbG,EAAgB,GAAAxN,OAAMqN,EAAN,gBAEhBI,EAASxO,KAAKyO,UAAUzO,KAAKqG,MAAMrE,SAAWhC,KAAKqG,MAAMrE,SAASC,GAAK,GAE7E,OACIyM,EAAA,qBAAKpI,UAAWQ,IAAW,eAAgBR,GAAYrE,GAAIuM,GACvDE,EAAA,sBAAMC,SAAU,SAACvD,GAAD,OAAWjF,EAAKwI,SAAS3M,EAAWoJ,KAChDsD,EAAA,qBAAKpI,UAAWQ,IAAW,yBAA0B,sBACjD4H,EAAA,uBACKjB,EACK,sEACAO,EAAO,oCAAAjN,OACQiB,EAAUC,IADlB,0CAAAlB,OAESiB,EAAUC,MAGlC+L,GACEU,EAAA,qBAAKpI,UAAWQ,IAAW,yBAA0B,oCACjD4H,EAAA,2BACIA,EAAA,uBAAO1Q,KAAK,WACRuO,KAAM+B,EACNM,QAAS5M,EAAUS,QACnB0I,SAAU,SAACC,GAAD,OAAWjF,EAAK0I,mBAAmB,UAAWzD,EAAMG,OAAOqD,UACrEtI,UAAU,2BALlB,+EAyBZoI,EAAA,qBAAKpI,UAAWQ,IAAW,oBAAqB,2BAC5C4H,EAAA,uBAAOI,QAAST,GAAhB,kCAGAK,EAAA,qBAAKpI,UAAU,0BACXoI,EAAA,0BAAUnC,KAAM8B,EACZpM,GAAIoM,EACJ/H,UAAWQ,IAAW,GAAI,2BAC1B7G,MAAO+B,EAAUkM,KACjB/C,SAAU,SAACC,GAAD,OAAWjF,EAAK0I,mBAAmB,OAAQzD,EAAMG,OAAOtL,QAClE8O,YAAY,sIAEhBL,EAAA,qBAAKpI,UAAU,mCACXoI,EAAA,2BACIA,EAAA,uBAAO1Q,KAAK,WACRuO,KAAMgC,EACNK,UAAW5M,EAAUgN,eACrB7D,SAAU,SAACC,GAAD,OAAWjF,EAAK0I,mBAAmB,iBAAkBzD,EAAMG,OAAOqD,UAC5EtI,UAAU,2BALlB,6JAUFtE,EAAUgN,gBACRN,EAAA,2gBAIFT,GACES,EAAA,qBAAKpI,UAAU,uBAAf,6UAQPtE,EAAUkM,OAASR,GAChBgB,EAAA,qBAAKpI,UAAWQ,IAAW,yBAA0B,wBAArD,qIAOJ8G,GACIc,EAAA,qBAAKpI,UAAW,0BAAhB,yCAOJtE,EAAU6L,QAAQxL,IAAI,SAAC4M,EAAcC,GACjC,IAAKD,EACD,OAAO,KAGX,IAAME,EAASF,EACTG,EAAY,GAAArO,OAAMqN,EAAN,YAAArN,OAA2BoO,EAAOlN,IAC9CoN,EAAgB,GAAAtO,OAAMqO,EAAN,SAChBE,EAAiB,GAAAvO,OAAMqO,EAAN,UACjBG,EAA0B,GAAAxO,OAAMqO,EAAN,kBAC1BI,EAAsB,GAAAzO,OAAMqO,EAAN,eAE5B,OACIV,EAAA,qBAAKpI,UAAW,yBAA0B1G,IAAKuP,EAAOlN,IAClDyM,EAAA,qBAAKpI,UAAWQ,IAAW,oBAAqB,0BAA2BlH,IAAG,GAAAmB,OAAKoO,EAAOlN,GAAZ,UAC1EyM,EAAA,0BACInC,KAAM6C,EACNnN,GAAImN,EACJnP,MAAOkP,EAAOjB,KACd/C,SAAU,SAACC,GAAD,OAAWjF,EAAKsJ,iBAAiBN,EAAQ,OAAQ/D,EAAMG,OAAOtL,QACxEqG,UAAWQ,IAAW,yBAA0B,2BAChDiI,YAAY,kIAEhBL,EAAA,wBAAQ1Q,KAAK,SAAS+I,QAAS,kBAAMZ,EAAKuJ,aAAaR,KAAvD,gDAKCC,EAAOjB,MACJQ,EAAA,qBAAKpI,UAAWQ,IAAW,yBAA0B,wBAArD,iIAKR4H,EAAA,qBAAKpI,UAAWQ,IAAW,oBAAqB,yBAA0B,6BAA8B,mCACpGlH,IAAG,GAAAmB,OAAKoO,EAAOlN,GAAZ,gBAEHyM,EAAA,2BACIA,EAAA,uBAAO1Q,KAAK,WACRuO,KAAMiD,EACNZ,QAASO,EAAOQ,WAChBxE,SAAU,SAACC,GAAD,OAAWjF,EAAKsJ,iBAAiBN,EAAQ,aAAc/D,EAAMG,OAAOqD,UAC9EtI,UAAU,2BALlB,qLAUJoI,EAAA,qBAAKpI,UAAWQ,IAAW,oBAAqB,yBAA0B,6BAA8B,mCACpGlH,IAAG,GAAAmB,OAAKoO,EAAOlN,GAAZ,eAEHyM,EAAA,2BACIA,EAAA,uBAAO1Q,KAAK,WACRuO,KAAM+C,EACNV,QAASO,EAAOS,cAChBzE,SAAU,SAACC,GAAD,OAAWjF,EAAKsJ,iBAAiBN,EAAQ,gBAAiB/D,EAAMG,OAAOqD,UACjFtI,UAAU,2BALlB,8HAUF6I,EAAOS,eACLlB,EAAA,qBAAKpI,UAAWQ,IAAW,oBAAqB,8BAA+BlH,IAAG,GAAAmB,OAAKoO,EAAOlN,GAAZ,oBAC9EyM,EAAA,uBAAOI,QAASS,GAAhB,qDAGAb,EAAA,qBAAKpI,UAAW,0BACZoI,EAAA,wBAAQzM,GAAIsN,EACRtP,MAAOkP,EAAOU,+BACdtD,KAAMgD,EACNpE,SAAU,SAACC,GAAD,OAAWjF,EAAKsJ,iBAAiBN,EAAQ,iCAAkCW,SAAS1E,EAAMG,OAAOtL,MAAO,QAEhHkP,EAAOU,gCACLnB,EAAA,wBAAQzO,MAAM,KAAd,uOAKAmF,EAAG/C,IAAI,SAAAL,GAAQ,OAAIA,GACf0M,EAAA,wBAAQ9O,IAAKoC,EAASC,GAAIhC,MAAO+B,EAASC,IAEpCD,EAASkM,SAK3BQ,EAAA,yBACIA,EAAA,mBAAGjE,KAAI,IAAA1J,OAAMoF,EAAKsI,UAAUU,EAAOU,kCAC9BV,EAAOU,+BAAiC,oDAAc,+EAI1DV,EAAOU,gCACJnB,EAAA,qBAAKpI,UAAU,uBAAf,yIAQpBoI,EAAA,qBAAKpI,UAAWQ,IAAW,oBAAqB,8BAA+BlH,IAAG,GAAAmB,OAAKoO,EAAOlN,GAAZ,UAC9EyM,EAAA,uBAAOI,QAASO,GAAhB,qDAGAX,EAAA,qBAAKpI,UAAW,0BACZoI,EAAA,wBAAQzM,GAAIoN,EACRpP,MAAOkP,EAAOY,aACdxD,KAAM8C,EACNlE,SAAU,SAACC,GAAD,OAAWjF,EAAKsJ,iBAAiBN,EAAQ,eAAgBW,SAAS1E,EAAMG,OAAOtL,MAAO,QAE9FkP,EAAOY,cACLrB,EAAA,wBAAQzO,MAAM,KAAd,uIAKAmF,EAAG/C,IAAI,SAAAL,GAAQ,OAAIA,GACf0M,EAAA,wBAAQ9O,IAAKoC,EAASC,GAAIhC,MAAO+B,EAASC,IAEpCD,EAASkM,SAK3BQ,EAAA,yBACIA,EAAA,mBAAGjE,KAAI,IAAA1J,OAAMoF,EAAKsI,UAAUU,EAAOY,gBAC9BZ,EAAOY,aAAe,oDAAc,+EAIxCZ,EAAOY,cACJrB,EAAA,qBAAKpI,UAAU,uBAAf,4IAYhCoI,EAAA,qBAAKpI,UAAW,0BACZoI,EAAA,wBAAQ1Q,KAAK,SAAS+I,QAAS,kBAAMZ,EAAK6J,cAA1C,oFAKJtB,EAAA,qBAAKpI,UAAW,0BACXmH,GACGiB,EAAA,wBAAQ1Q,KAAK,SAASsI,UAAW,wBAAjC,kHAKAtG,KAAKqG,MAAM4J,UACPvB,EAAA,wBAAQ1Q,KAAK,SAASsI,UAAW,uBAAwBS,QAAS,kBAAMZ,EAAKE,MAAM4J,SAAUjO,KAA7F,wFAlThC,CAAApC,IAAA,qBAAAK,MAAA,SA8T0DiQ,EAAaC,GAC/D,IAAMnO,EAAQlC,OAAA6B,EAAA,EAAA7B,CAAA,GAAQE,KAAKnC,MAAMmE,SAAnBlC,OAAA4B,EAAA,EAAA5B,CAAA,GAA8BoQ,EAAWC,IACvDnQ,KAAK8K,SAAS,CACV9I,WACA0L,eAAe,IAGd1N,KAAKnC,MAAM4P,OACZzN,KAAK2O,SAAS3M,KAtU1B,CAAApC,IAAA,mBAAAK,MAAA,SA2UsDmQ,EAAyBF,EAAaC,GACpF,IAAME,EAAavQ,OAAA6B,EAAA,EAAA7B,CAAA,GAAQsQ,EAARtQ,OAAA4B,EAAA,EAAA5B,CAAA,GAAyBoQ,EAAWC,IACjDtC,EAAU7N,KAAKnC,MAAMmE,SAAU6L,QAAQxL,IAAI,SAAA8M,GAAM,OAAIA,GAAUA,EAAOlN,KAAOmO,EAAenO,GAAKoO,EAAgBlB,IACvHnP,KAAK6O,mBAAmB,UAAWhB,KA9U3C,CAAAjO,IAAA,WAAAK,MAAA,SAkVqB+B,EAAqBoJ,GAC9BA,GACAA,EAAMkF,iBAGLtO,EAASkM,OAIVlO,KAAKnC,MAAM4P,MACPrC,IACApL,KAAKqG,MAAMkK,OAAOvO,GAClBhC,KAAK8K,SAAS,CACV4C,eAAe,EACf1L,SAzWT,CACHC,GAAI,EACJiM,KAAM,GAENL,QAAS,OAyWL7N,KAAKqG,MAAMkK,OAAOvO,MApW9B,CAAApC,IAAA,eAAAK,MAAA,SAyWyBuQ,GACjB,IAAM3C,EAAU7N,KAAKnC,MAAMmE,SAAU6L,QAAQxL,IAAI,SAAC8M,EAAQD,GAAT,OAAoBC,GAAUD,IAAUsB,EAAqBrB,EAAP,OACvGnP,KAAK6O,mBAAmB,UAAWhB,KA3W3C,CAAAjO,IAAA,YAAAK,MAAA,WAgXQ,IAAMwQ,EAAezQ,KAAKnC,MAAMmE,SAAU6L,QACpC6C,EAAqB,CACvBzO,GAAIwO,EAAapS,OAAS,EAC1B6P,KAAM,GACN6B,aAAc,GAEZlC,EAAO,GAAA9M,OAAAjB,OAAAoC,EAAA,EAAApC,CAAO2Q,GAAP,CAAqBC,IAClC1Q,KAAK6O,mBAAmB,UAAWhB,KAvX3C,CAAAjO,IAAA,YAAAK,MAAA,SA2XsBiF,GAEd,OAAOA,EAAU,GAAAnE,OADF,qBACE,KAAAA,OAAgBmE,GAAhB,GAAAnE,OADF,qBACE,WA7XzB,EAAAnB,IAAA,2BAAAK,MAAA,SAQoCoG,EAA2BxI,GACvD,ICzCsBmE,EDyChB2O,EAAetK,EAAMrE,SACrB4O,EAAgB/S,EAAMmE,SAE5B,OAAI2O,EACIC,GAAiBA,EAAc3O,KAAO0O,EAAa1O,GAE5C,CACPwL,OAAO,EACPC,eAAe,EACf1L,SAASlC,OAAA6B,EAAA,EAAA7B,CAAA,GACF8Q,EADC,CAEJnO,QAASkO,EAAalO,WAInB,CACPgL,OAAO,EACPC,eAAe,EACf1L,UC3DcA,ED2DU2O,EC1D7B7Q,OAAA6B,EAAA,EAAA7B,CAAA,GACFkC,EADL,CAEE6L,QAAS7L,EAAS6L,QAAQxL,IAAI,SAAA8M,GAAM,OAAIA,EAAMrP,OAAA6B,EAAA,EAAA7B,CAAA,GAAQqP,GAAW,WD2DpDyB,EACA,KAGJ,CACHnD,OAAO,EACPC,eAAe,EACf1L,SA9CD,CACHC,GAAI,EACJiM,KAAM,GAENL,QAAS,SAKjBZ,EAAA,CAAkC1F,aE4CrBsJ,GAAsBnJ,YA/D+C,SAAC7J,GAAD,MAAY,CAC1FoD,UAAWpD,EAAMoD,UAAUA,YA8DIyG,CA1DuC,SAACrB,GACvE,IAAMjB,EAAKiB,EAAMpF,UAEjB,OACI0F,EAAAC,EAAAC,cAAA,WACIF,EAAAC,EAAAC,cAAA,yIAEIF,EAAAC,EAAAC,cAAA,WAFJ,kUAIIF,EAAAC,EAAAC,cAAA,WAJJ,0WAMIF,EAAAC,EAAAC,cAAA,WANJ,6aASAF,EAAAC,EAAAC,cAAA,wUAGQ/G,OAAOwD,KAAKwJ,GAAkBzK,IAAI,SAAC0M,EAAaG,GAAd,OAC9BvI,EAAAC,EAAAC,cAAA,OAAKjH,IAAKsP,GACJH,EADN,MACwBjC,EAAiBiC,OAMrDpI,EAAAC,EAAAC,cAACiK,GAAD,CACIxK,UAAU,gCACViK,OAAQ,SAACvO,GAAD,OAAcoC,EAAI2M,YAAY/O,IACtCoD,GAAIA,IAIJA,EAAG/C,IAAI,SAAAL,GAAQ,OAAIA,GACf2E,EAAAC,EAAAC,cAACiK,GAAD,CACIxK,UAAU,gCACVtE,SAAUA,EACVpC,IAAKoC,EAASC,GACdsO,OAAQ,SAACvO,GAAD,OAAcoC,EAAI4M,eAAehP,IACzCiO,SAAU,SAACjO,GAAD,OAAcoC,EAAI6M,eAAejP,IAC3CoD,GAAIA,MAKhBuB,EAAAC,EAAAC,cAAA,OAAKP,UAAU,uCACXK,EAAAC,EAAAC,cAAA,UAAQ7I,KAAK,SACT+I,QAAS,kBAAM3C,EAAIsB,UAAUtB,EAAIrF,aAAaQ,QADlD,2EC7ChB,IAKM2R,8MAEFrT,MAAQ,CACJ+F,KCzBG,CACHuN,UAAW,GACXC,SAAU,GACVC,MAAO,GACPxN,MAAO,GACPsB,eAAgB,4EDuBX,IAAAgB,EAAAnG,KACCsR,EAAM,mBACNC,EAAW,GAAAxQ,OAAMuQ,EAAN,OACXE,EAAU,GAAAzQ,OAAMuQ,EAAN,OACVG,EAAO,GAAA1Q,OAAMuQ,EAAN,UACPI,EAAO,GAAA3Q,OAAMuQ,EAAN,UAEb,OACI3K,EAAAC,EAAAC,cAAA,MAAIP,UAAWtG,KAAKqG,MAAMC,WACtBK,EAAAC,EAAAC,cAAA,UACIF,EAAAC,EAAAC,cAAA,SAAOiI,QAASyC,EAAajL,UAAU,2BAAvC,uBAGAK,EAAAC,EAAAC,cAAA,SAAO7I,KAAK,OACRsI,UAAU,MACVrE,GAAIsP,EACJhF,KAAMgF,EACNI,UAAW,IACX1R,MAAOD,KAAKnC,MAAM+F,KAAKuN,UACvBhG,SAAU,SAACC,GAAD,OAAWjF,EAAKyL,WAAW,YAAaxG,OAG1DzE,EAAAC,EAAAC,cAAA,UACIF,EAAAC,EAAAC,cAAA,SAAOiI,QAAS0C,EAAYlL,UAAU,2BAAtC,+CAGAK,EAAAC,EAAAC,cAAA,SAAO7I,KAAK,OACRsI,UAAU,MACVrE,GAAIuP,EACJjF,KAAMiF,EACNG,UAAW,IACX1R,MAAOD,KAAKnC,MAAM+F,KAAKwN,SACvBjG,SAAU,SAACC,GAAD,OAAWjF,EAAKyL,WAAW,WAAYxG,OAGzDzE,EAAAC,EAAAC,cAAA,UACIF,EAAAC,EAAAC,cAAA,SAAOiI,QAAS2C,EAASnL,UAAU,2BAAnC,+CAGAK,EAAAC,EAAAC,cAAA,SAAO7I,KAAK,OACRsI,UAAU,MACVrE,GAAIwP,EACJlF,KAAMkF,EACNE,UAAW,IACX1R,MAAOD,KAAKnC,MAAM+F,KAAKC,MACvBsH,SAAU,SAACC,GAAD,OAAWjF,EAAKyL,WAAW,QAASxG,OAGtDzE,EAAAC,EAAAC,cAAA,UACIF,EAAAC,EAAAC,cAAA,SAAOiI,QAAS4C,EAASpL,UAAU,2BAAnC,mCAGAK,EAAAC,EAAAC,cAAA,SAAO7I,KAAK,OACRsI,UAAU,MACVrE,GAAIyP,EACJnF,KAAMmF,EACNC,UAAW,IACX1R,MAAOD,KAAKnC,MAAM+F,KAAKyN,MACvBlG,SAAU,SAACC,GAAD,OAAWjF,EAAKyL,WAAW,QAASxG,2CAQ/CyG,EAAuBzG,GACtC,IAAMnL,EAAQmL,EAAMG,OAAOtL,MACrB2D,EAAI9D,OAAA6B,EAAA,EAAA7B,CAAA,GAAQE,KAAKnC,MAAM+F,KAAnB9D,OAAA4B,EAAA,EAAA5B,CAAA,GAA0B+R,EAAW5R,IAC/CD,KAAK8K,SAAS,CAAElH,SAChBQ,EAAI0N,aAAalO,UA5Ee2D,IAAMC,WAkFjCuK,GAAmBrK,YAvF2C,SAAC7J,GAAD,MAAY,CACnFyB,MAAOzB,EAAMsG,QAAQ7E,QAsFOoI,CAAyBwJ,IE3EnDc,8MAEFnU,MAAqB,CACjBoU,UAAW,GACX3Q,kBAAmB,2EAYd,IAMD4Q,EANC/L,EAAAnG,KAECsB,EAAoBtB,KAAKqG,MAAM/E,kBAC/BL,EAAYjB,KAAKqG,MAAMpF,UACvBkR,EAAUnS,KAAKqG,MAAMvD,iBAS3B,KAHIoP,EAHC5Q,EAGiBL,EAAW6M,OAAO,SAAA9L,GAAQ,QAAIA,GAAWA,EAASC,KAAOX,IAA2B,GAFpFL,EAAW6M,OAAO,SAAA9L,GAAQ,QAAIA,GAAWA,EAASS,UAAiB,IAMrF,OACIkE,EAAAC,EAAAC,cAAA,yPAAmDvF,EAAnD,wDAIR,IAAM0M,EAA6D,IAAnDkE,EAAgBrE,QAAQC,OAAOC,SAAS1P,OAElD+T,EADSF,EAAgBhE,KAAKmE,SN7DC,cM8DLF,IAAYA,EAAQtO,QAC3CsO,EAAQhB,YAAcgB,EAAQf,WAAce,EAAQd,OAE7D,OACI1K,EAAAC,EAAAC,cAAA,WAMIF,EAAAC,EAAAC,cAAA,OAAKP,UAAWQ,IAAW,cAAe,cACpC9G,KAAKsS,mBAAmBJ,KAE5BlE,IAAYoE,GACVzL,EAAAC,EAAAC,cAAA,MAAIP,UAAU,kBAEN4L,EAAgBrE,QAAQxL,IAAI,SAAA8M,GACxB,OAAKA,GAAWA,EAAOjB,MAASiB,EAAOY,aAKnCpJ,EAAAC,EAAAC,cAAA,MAAIjH,IAAKuP,EAAOlN,GAAIqE,UAAU,2BACxBH,EAAKoM,aAAapD,IALjB,QAY1BnB,GACGrH,EAAAC,EAAAC,cAAA,MAAIP,UAAU,wBACVK,EAAAC,EAAAC,cAAA,UACIF,EAAAC,EAAAC,cAAA,UAAQ7I,KAAK,SACT+I,QAAS,kBAAM3C,EAAIwD,gBADvB,sGAMJjB,EAAAC,EAAAC,cAAA,UACIF,EAAAC,EAAAC,cAAA,UAAQ7I,KAAK,SACT+I,QAAS,kBAAM3C,EAAIsB,UAAUtB,EAAIrF,aAAaQ,QADlD,0JAaH4P,GAAqC,IAAAhI,EAAAnH,KACtD,GAAImP,EAAOS,cACP,OACIjJ,EAAAC,EAAAC,cAAA,OAAKP,UAAU,+BACXK,EAAAC,EAAAC,cAAA,SAAO7I,KAAK,OACR2T,UAAW,IACX1R,MAAOD,KAAKnC,MAAMoU,UAClB9G,SAAU,SAACC,GAAD,OAAWjE,EAAK2D,SAAS,CAAEmH,UAAW7G,EAAMG,OAAOtL,SAC7DqG,UAAU,MACVyI,YAAY,6GAEd/O,KAAKnC,MAAMoU,WACTtL,EAAAC,EAAAC,cAAA,UAAQ7I,KAAK,SACTsI,UAAU,2BACVS,QAAS,kBAAMI,EAAKqL,qBAAqBrD,KAF7C,0FAWhB,IAAIjB,EAAOiB,EAAOjB,KAClB,GAAIiB,EAAOQ,WAAY,CACnB,IAAM8C,EAAQvE,EAAKC,MAAM,MAEzBD,EAAOuE,EADiBC,KAAKC,MAAMD,KAAKE,SAAWH,EAAMpU,SAI7D,OACIsI,EAAAC,EAAAC,cAAA,UAAQ7I,KAAK,SAAS+I,QAAS,kBAAMI,EAAKqL,qBAAqBrD,IAC3D7I,UAAWQ,IAAW,gBAAiB,cAErC9G,KAAK6S,aAAa3E,iDAMHiB,GACzB,IAAIY,EAAmCZ,EAAOY,aAE9C,GAAIZ,EAAOS,cAAe,CACtB,IAAMkD,EAAgB3D,EAAOjB,KAAKjD,cAAcxH,OAEhDsM,EADmB/P,KAAKnC,MAAMoU,UAAUhH,cAAcxH,SACxBqP,EACxB3D,EAAOY,aACPZ,EAAOU,+BAGjBzL,EAAI2L,aAAaA,GAAgB,8CAIV/N,GACvB,GAAIA,EAASgN,eAAgB,CACzB,IAAMyD,EAAQzQ,EAASkM,KAAKC,MAAM,MAAML,OAAOC,SAEzCG,EAAOuE,EADWC,KAAKC,MAAMD,KAAKE,SAAWH,EAAMpU,SAEzD,OAAO2B,KAAK6S,aAAa3E,GAG7B,GAAIlM,EAASkM,KAAKmE,SNlLmB,WMkLO,CACxC,IAAMU,EAAY/Q,EAASkM,KAAKC,MNnLC,WMoLjC,MAAO,CACHnO,KAAK6S,aAAaE,EAAU,GAAGtP,QAC/BkD,EAAAC,EAAAC,cAACmM,GAAD,CAAkBpT,IAAK,EAAG0G,UAAU,wBACpCtG,KAAK6S,aAAaE,EAAU,GAAGtP,SAIvC,OAAOzD,KAAK6S,aAAa7Q,EAASkM,2CAIjBA,GACjB,IAAKA,EAAKmE,SN/L6B,aMgMnC,OAAOnE,EAEX,IAAMmD,EAAQrR,KAAKqG,MAAMvD,kBAAoB9C,KAAKqG,MAAMvD,iBAAiBuO,OAAS,2EAClF,OAAOnD,EAAKC,MNnM2B,aMmMH8E,KAAK5B,sDAnKbhL,EAAmBxI,GAC/C,OAAIwI,EAAM/E,mBAAqB+E,EAAM/E,oBAAsBzD,EAAMyD,kBACtDxB,OAAA6B,EAAA,EAAA7B,CAAA,GAAKjC,EAAZ,CAAmBoU,UAAW,KAE3B,YAZc1K,IAAMC,WAiLtB0L,GAAQxL,YAxLoE,SAAC7J,GAAD,MAAY,CACjGoD,UAAWpD,EAAMoD,UAAUA,UAC3BK,kBAAmBzD,EAAMoD,UAAUK,kBACnCwB,iBAAkBjF,EAAMqD,MAAM4B,mBAqLb4E,CAAyBsK,IC9KjCmB,GAAUzL,YApB2C,SAAC7J,GAAD,MAAY,CAC1EyB,MAAOzB,EAAMsG,QAAQ7E,QAmBFoI,CAf2B,SAAA+E,GAC9C,OAD6DA,EAAZnN,OAE7C,KAAK8E,EAAIrF,aAAakG,MAClB,OAAO0B,EAAAC,EAAAC,cAACuM,GAAD,MACX,KAAKhP,EAAIrF,aAAa2N,qBAClB,OAAO/F,EAAAC,EAAAC,cAACwM,GAAD,MACX,KAAKjP,EAAIrF,aAAa4G,WAClB,OAAOgB,EAAAC,EAAAC,cAACyM,EAAD,MACX,KAAKlP,EAAIrF,aAAaQ,KACtB,QACI,OAAOoH,EAAAC,EAAAC,cAAC0M,EAAD,SCONlP,GAAMqD,YAtB2C,SAAC7J,GAAD,MAAY,CACtEyB,MAAOzB,EAAMsG,QAAQ7E,QAqBNoI,CAjBuB,SAAA+E,GAAe,IAAZnN,EAAYmN,EAAZnN,MACnCmH,EAAqB,CACvB+M,cAAiBlU,IAAUP,EAAaQ,KACxCkU,qBAAsBnU,IAAUP,EAAakG,OAGjD,OACI0B,EAAAC,EAAAC,cAAA,OAAKP,UAAWQ,IAAW,MAAOL,IAC9BE,EAAAC,EAAAC,cAAA,OAAKP,UAAU,kBACXK,EAAAC,EAAAC,cAAC6M,EAAD,CAAWpN,UAAU,gBACrBK,EAAAC,EAAAC,cAACsM,GAAD,mBCtBHQ,GAAcC,aAA2B,CAClD1P,WAAY/E,EACZgF,QAAS1E,EACTwB,UAAWa,EACXZ,MAAO8B,ICEEpF,GAA0B,CACnCsG,WAAYlF,EACZmF,QAAS9E,EACT4B,UAAWG,EACXF,MAAO0B,GCVX,IAAMhE,GCOGiV,aAAYF,GAAa/V,IDLlCwG,EAAI0P,SAASlV,IAEb,IAAMmV,GACFpN,EAAAC,EAAAC,cAACmN,EAAA,EAAD,CAAUpV,MAAOA,IACb+H,EAAAC,EAAAC,cAACoN,GAAD,OAIRC,SAASC,MAAQ,iBAEjBC,IAASC,OAAON,GAAYG,SAASI,eAAe","file":"static/js/main.fbba748b.chunk.js","sourcesContent":["import { Reducer } from 'redux'\nimport { IAction } from './store';\n\n\n// { actionName: (state, action) => state }\nexport type IReducerObj<TState, TActionsToPayloads> = {\n    [K in keyof TActionsToPayloads]: Reducer<TState, IAction<TActionsToPayloads[K]>>\n}\n\n\nexport function createReducer<TActionsToPayload, TState>\n        (reducerObj: IReducerObj<TState, TActionsToPayload>, initialState: TState)\n{\n    return (state: TState | undefined, action: IAction<any>) => {\n        if (!state) {\n            return initialState;\n        }\n\n        const actionType: keyof TActionsToPayload = action.type as keyof TActionsToPayload;\n        const reducer = (reducerObj as any)[actionType] as Reducer<TState, IAction<any>>;\n        if (reducer) {\n            return reducer(state!, action) as TState;\n        }\n        return state!;\n    };\n}\n","import { IAppStore } from './store';\n\n\ntype IDoActionsWithPayload<TActionsToPayload> = {\n    [K in keyof TActionsToPayload]: (store: IAppStore | null, payload: TActionsToPayload[K]) => void;\n}\n\n\nexport function createDoActions<TActionsToPayload>(...actionsNamesList: Array<keyof TActionsToPayload>): IDoActionsWithPayload<TActionsToPayload> {\n    return actionsNamesList.reduce((memo, actionName) => {\n        memo[actionName] = (store, payload) => {\n            if (!store) {\n                return;\n            }\n\n            store.dispatch({\n                type: actionName as string,\n                payload\n            });\n        };\n        return memo;\n    }, {} as IDoActionsWithPayload<TActionsToPayload>);\n}\n","export interface IFullScreenState {\n    inFullscreen: boolean\n};\n\n\nexport const fullScreenInitialState: IFullScreenState = {\n    inFullscreen: false\n};\n","export enum ROUTE_STATES {\n    MAIN = 'MAIN',\n    ADMIN_MAIN = 'ADMIN_MAIN',\n    ADMIN_QUESTIONS_LIST = 'ADMIN_QUESTIONS_LIST',\n    QUEST = 'QUEST',\n}\n","import { createReducer, IReducerObj } from '../create-reducer';\nimport { createDoActions } from '../create-do-actions';\nimport { IFullScreenState, fullScreenInitialState } from './full-screen-state';\n\n\nexport interface IFullScreenActionsToPayloads {\n    TOGGLE: void\n}\n\n\nexport const fullScreenActions = createDoActions<IFullScreenActionsToPayloads>('TOGGLE');\n\n\nconst reducerObj: IReducerObj<IFullScreenState, IFullScreenActionsToPayloads> = {\n    'TOGGLE': (state) => ({\n        inFullscreen: !state!.inFullscreen\n    }),\n};\n\n\nexport const fullScreenReducer = createReducer(reducerObj, fullScreenInitialState);\n","import { ROUTE_STATES } from '../../app/route-states';\n\n\nexport interface IRoutingState {\n    route: ROUTE_STATES;\n};\n\n\nexport const routeInitialState: IRoutingState = {\n    route: ROUTE_STATES.MAIN\n};\n","import { createReducer, IReducerObj } from '../create-reducer';\nimport { createDoActions } from '../create-do-actions';\nimport { IRoutingState, routeInitialState } from './routing-state';\nimport { ROUTE_STATES } from '../../app/route-states';\n\n\nexport interface IRoutingActionsToPayloads {\n    GO_TO: ROUTE_STATES;\n}\n\n\nexport const routingActions = createDoActions<IRoutingActionsToPayloads>('GO_TO');\n\n\nconst reducerObj: IReducerObj<IRoutingState, IRoutingActionsToPayloads> = {\n    'GO_TO': (state, action) => ({\n        route: action.payload\n    }),\n};\n\n\nexport const routingReducer = createReducer(reducerObj, routeInitialState);\n","import { IQuestionsList } from '../models/qa';\nimport { IUser } from '../models/user';\n\n\nclass StorageValue<T> {\n\n    constructor(private key = '') {\n    }\n\n\n    store(value: T) {\n        const serializedValue = JSON.stringify(value);\n        window.localStorage.setItem(this.key, serializedValue);\n    }\n\n\n    restore(defaultValue?: T): T | null {\n        const defaultValueToUse = defaultValue || null;\n        const serializedValue = window.localStorage.getItem(this.key);\n        if (!serializedValue) {\n            return defaultValueToUse;\n        }\n        try {\n            return JSON.parse(serializedValue) as T;\n        } catch (e) {\n            console.error('serialized value', serializedValue);\n            console.error(`while parsing serialized value from key ${this.key}`, e);\n        }\n        return defaultValueToUse;\n    }\n}\n\n\nexport const storage = {\n    questions: new StorageValue<IQuestionsList>('mobius2019_questions'),\n    users: new StorageValue<IUser[]>('mobius2019_users'),\n    adminPass: new StorageValue<string>('mobius2019_adminPass'),\n};\n","import { IQuestionsList } from '../../models/qa';\nimport { storage } from '../../utils/storage';\n\n\nexport interface IQuestionsState {\n    questions: IQuestionsList;\n    currentQuestionId: number;\n};\n\n\nexport const questionsInitialState: IQuestionsState = {\n    questions: storage.questions.restore([]) as IQuestionsList,\n    currentQuestionId: 0,\n};\n","export function extendState<T>(state: T, toAdd: Partial<T>): T;\nexport function extendState<T, K extends keyof T>(state: T, key: K, value: T[K]): T\n\nexport function extendState<T, K extends keyof T>(state: T, toAddOrKey: Partial<T> | K, value?: T[K]): T {\n    const toAdd = arguments.length === 3\n        ? ({ [toAddOrKey as K]: value } as any) as Partial<T>\n        : toAddOrKey as Partial<T>;\n    return {\n        ...state,\n        ...toAdd\n    };\n}\n","import { createReducer, IReducerObj } from '../create-reducer';\nimport { createDoActions } from '../create-do-actions';\nimport { IQuestionsState, questionsInitialState } from './questions-state';\nimport { IQuestion, INewQuestion, IQuestionsList } from '../../models/qa';\nimport { extendState } from '../../utils/extend-state';\n\n\nexport interface IQuestionsActionsToPayloads {\n    ADD: INewQuestion,\n    DELETE: IQuestion,\n    UPDATE: IQuestion,\n    REPLACE: IQuestionsList,\n    GO_TO_QUESTION: number,\n}\n\n\nexport const questionsActions = createDoActions<IQuestionsActionsToPayloads>(\n    'ADD', 'DELETE', 'UPDATE', 'REPLACE', 'GO_TO_QUESTION',\n);\n\n\nconst reducerObj: IReducerObj<IQuestionsState, IQuestionsActionsToPayloads> = {\n    'ADD': (state, action) => {\n        // INewQuestion will become IQuestion after 'id' will be added.\n        const question = { ...action.payload } as IQuestion;\n        const questions = state!.questions;\n        question.id = questions.length + 1;\n        return extendState(state!, 'questions', [...questions, question]);\n    },\n    'DELETE': (state, action) => {\n        const questionToDelete = action.payload;\n        const questions = state!.questions.map(question =>\n            question && question.id !== questionToDelete.id ? question : null);\n        return extendState(state!, 'questions', questions);\n    },\n    'UPDATE': (state, action) => {\n        const questionToUpdate = action.payload;\n        const resetIsFirst = questionToUpdate.isFirst;\n        const questions = state!.questions.map(question => {\n            if (!question) {\n                return null;\n            }\n            if (resetIsFirst) {\n                question = { ...question, isFirst: false };\n            }\n            return question.id === questionToUpdate.id ? questionToUpdate : question;\n        });\n        return extendState(state!, 'questions', questions);\n    },\n    'GO_TO_QUESTION': (state, action) => {\n        return extendState(state!, 'currentQuestionId', action.payload);\n    },\n    'REPLACE': (state, action) => {\n        return extendState(state!, 'questions', action.payload);\n    },\n};\n\n\nexport const questionsReducer = createReducer(reducerObj, questionsInitialState);\n","import { padStart } from './text';\n\nexport enum FILE_TYPES {\n    JSON = 'JSON',\n    CSV = 'CSV',\n}\n\n\nconst mimeTypes: { [key in FILE_TYPES]: string } = {\n    JSON: 'application/json',\n    CSV: 'text/csv',\n};\n\n\nexport interface IFileDescription {\n    content: any;\n    nameSection: string; // имя в файле без timestamp и расширения\n    type: FILE_TYPES;\n}\n\n\n/**\n * Выгружает пользователю файл.\n * @see http://jsfiddle.net/UselessCode/qm5AG/\n * @param {object} params\n * @param {string} params.content\n * @param {string} params.type MIME-type.\n * @param {string} [params.charset='utf-8']\n * @param {object} [params.fileObject] Ранее сгенерированный объект для выгрузки этого файла.\n * @returns {File|Blob} See URL.createObjectURL API.\n */\nexport function getFileObject(params: {\n    content: string,\n    fileType: FILE_TYPES,\n    charset?: string,\n    fileObjectUrl?: string\n}): string {\n  releaseFileObject(params.fileObjectUrl);\n\n  const charset = params.charset || 'utf-8';\n  const mimeType = mimeTypes[params.fileType];\n  const type = `data:${mimeType};charset=${charset}`;\n  const data = new Blob([params.content], { type });\n  const fileObject = window.URL.createObjectURL(data);\n  return fileObject;\n}\n\n/**\n * @see http://jsfiddle.net/UselessCode/qm5AG/\n */\nexport function releaseFileObject(fileObjectUrl?: string) {\n  if (fileObjectUrl) {\n    // If we are replacing a previously generated file we need to\n    // manually revoke the object URL to avoid memory leaks.\n    window.URL.revokeObjectURL(fileObjectUrl);\n  }\n}\n\n\n/**\n * Запрашивает у пользователю разделитель для значений в CSV.\n * @param {string} [defaultDelimiter=';']\n * @returns {string}\n */\n/*\nexport function getCSVDelimiter(defaultDelimiter = ';') {\n  const userDelimiter = prompt(`Введите разделитель для CSV.\\n`\n    + `По умолчанию будет использован символ \"${defaultDelimiter}\".`, defaultDelimiter);\n  return userDelimiter || defaultDelimiter;\n}\n*/\n\n\n/**\n * Читает с диска файл.\n * @param {File} file Объект File, который может быть получен из input/type=file.\n * @returns {Promise<string>}\n */\nexport function readFileAsString(file: File): Promise<string> {\n    return new Promise<string>((resolve, reject) => {\n        const reader = new FileReader();\n\n        reader.onload = (event: ProgressEvent) => {\n            const content = (event.target as any).result;\n            resolve(content);\n        };\n\n        reader.onerror = (error) => {\n            reject(error);\n        };\n\n        reader.readAsText(file);\n    });\n}\n\n\n/**\n * Получение timestamp для использования в именах файлов, например.\n * @returns {string}\n */\nfunction getTimestamp() {\n    const now = new Date();\n    const y = now.getFullYear();\n    const m = padStart(now.getMonth() + 1, 2, '0');\n    const d = padStart(now.getDate(), 2, '0');\n    const H = padStart(now.getHours(), 2, '0');\n    const M = padStart(now.getMinutes(), 2, '0');\n    const S = padStart(now.getSeconds(), 2, '0');\n    return `${y}-${m}-${d}--${H}-${M}-${S}`;\n}\n\n\nexport function getFileName(section: string, extension?: string): string {\n    const timestamp = getTimestamp();\n    const fileName = extension\n        ? `${section}-${timestamp}.${extension}`\n        : `${timestamp}-${section}`;\n    return fileName;\n}\n","import { IUser } from '../../models/user';\nimport { storage } from '../../utils/storage';\n\n\nexport interface IUsersState {\n    users: IUser[];\n    currentUser: IUser | null;\n    registrationUser: IUser | null;\n};\n\n\nexport const usersInitialState: IUsersState = {\n    users: storage.users.restore([]) as IUser[],\n    currentUser: null,\n    registrationUser: null,\n};\n","import { createReducer, IReducerObj } from '../create-reducer';\nimport { createDoActions } from '../create-do-actions';\nimport { IUsersState, usersInitialState } from './users-state';\nimport { IUser } from '../../models/user';\nimport { extendState } from '../../utils/extend-state';\n\n\nexport interface IUsersActionsToPayloads {\n    REG_USER: IUser;\n    ADD_OR_UPDATE: IUser;\n    CLEAR_REG_USER: void;\n}\n\n\nexport const usersActions = createDoActions<IUsersActionsToPayloads>('ADD_OR_UPDATE', 'REG_USER', 'CLEAR_REG_USER');\n\n\nconst reducerObj: IReducerObj<IUsersState, IUsersActionsToPayloads> = {\n    'CLEAR_REG_USER': (state) => extendState(state!, 'registrationUser', null),\n    'REG_USER': (state, action) => extendState(state!, 'registrationUser', action.payload),\n    'ADD_OR_UPDATE': (state, action) => {\n        const rawUser = action.payload;\n        const newUser = Object.keys(rawUser).reduce<IUser>((memo, key) => {\n            const userKey = key as keyof IUser;\n            const newValue = rawUser[userKey];\n            memo[userKey] = typeof newValue === 'string' ? newValue.trim() : newValue;\n            return memo;\n        }, {} as IUser);\n        const sameUserIndex = state!.users.findIndex(user => user.phone === newUser.phone);\n        const hasSameUser = sameUserIndex !== -1;\n        let newUsersList = [...state!.users];\n        if (hasSameUser) {\n            newUsersList[sameUserIndex] = newUser;\n        } else {\n            newUsersList.push(newUser);\n        }\n        extendState(state!, 'currentUser', newUser);\n        return extendState(state!, 'users', newUsersList);\n    },\n};\n\n\nexport const usersReducer = createReducer(reducerObj, usersInitialState);\n","import { fullScreenActions } from './full-screen/full-screen-reducer';\nimport { routingActions } from './routing/routing-reducer';\nimport { questionsActions } from './questions/questions-reducer';\nimport { usersActions } from './users/users-reducer';\n\n\nexport const doActions = {\n    fullScreen: fullScreenActions,\n    routing: routingActions,\n    questions: questionsActions,\n    users: usersActions,\n};\n","import { App } from './app';\n\nexport const app = new App();\n\nexport * from './route-states';\n","import { Unsubscribe } from 'redux';\nimport { IAppStore } from '../redux/store';\nimport { IAppState } from '../redux/state';\nimport { doActions } from '../redux/do-actions';\nimport { ROUTE_STATES } from './route-states';\nimport { IQuestion, IQuestionsList } from '../models/qa';\nimport { IExportedQuestions } from '../models/export';\nimport { storage } from '../utils/storage';\nimport { IUser } from '../models/user';\nimport md5 from 'blueimp-md5';\n\nexport class App {\n\n    private _store: IAppStore | null = null;\n\n    private storeUnsubscriber: Unsubscribe | null = null;\n\n    private storedQuestions: IQuestionsList = [];\n    private storedUsers: IUser[] = [];\n\n    private get state(): IAppState {\n        return this._store!.getState();\n    }\n\n\n    ROUTE_STATES = ROUTE_STATES;\n\n\n    setStore(store: IAppStore) {\n        this._store = store;\n        this.unsubscribeStore();\n        if (store) {\n            store.subscribe(() => {\n                const state = store.getState();\n                this.storeQuestions(state);\n                this.storeUsers(state);\n            });\n        }\n    }\n\n\n    restartGame() {\n        doActions.users.CLEAR_REG_USER(this._store);\n        doActions.questions.GO_TO_QUESTION(this._store, 0);\n        doActions.routing.GO_TO(this._store, ROUTE_STATES.QUEST);\n    }\n\n\n    toggleFullscreen() {\n        doActions.fullScreen.TOGGLE(this._store);\n    }\n\n\n    goToRoute(route: ROUTE_STATES) {\n        doActions.routing.GO_TO(this._store, route);\n    }\n\n\n    addQuestion(question: IQuestion) {\n        doActions.questions.ADD(this._store, question);\n    }\n\n\n    deleteQuestion(question: IQuestion) {\n        doActions.questions.DELETE(this._store, question);\n    }\n\n\n    updateQuestion(question: IQuestion) {\n        doActions.questions.UPDATE(this._store, question);\n    }\n\n\n    nextQuestion(questionId: number) {\n        doActions.questions.GO_TO_QUESTION(this._store, questionId);\n        const registrationUser = this.state.users.registrationUser;\n        if (registrationUser) {\n            doActions.users.ADD_OR_UPDATE(this._store, {\n                ...registrationUser,\n                lastQuestionId: questionId\n            });\n        }\n    }\n\n    updateQuestions(questions: IQuestionsList | IExportedQuestions) {\n        const qs = questions instanceof Array ? questions : (questions as IExportedQuestions).questions;\n        doActions.questions.REPLACE(this._store, qs);\n    }\n\n\n    registerUser(user: IUser) {\n        doActions.users.REG_USER(this._store, user);\n    }\n\n\n    goToAdmin() {\n        const storedAdminPassHash = storage.adminPass.restore();\n        const adminPass = prompt('Введите пароль для доступа к разделу \"Администрирование\"', '');\n\n        if (!adminPass) {\n            alert('Вы не ввели пароль!');\n            return;\n        }\n\n        const adminPassHash = md5(adminPass);\n\n        if (storedAdminPassHash) {\n            if (storedAdminPassHash !== adminPassHash) {\n                alert('Пароль введён неверно!');\n                return;\n            }\n        } else {\n            storage.adminPass.store(adminPassHash);\n            alert('Пароль сохранён!');\n        }\n\n        this.goToRoute(ROUTE_STATES.ADMIN_MAIN);\n    }\n\n\n    private unsubscribeStore() {\n        if (this.storeUnsubscriber) {\n            this.storeUnsubscriber();\n            this.storeUnsubscriber = null;\n        }\n    }\n\n\n    private storeQuestions(state: IAppState) {\n        const stateQuestions = state.questions.questions;\n        if (stateQuestions !== this.storedQuestions) {\n            this.storedQuestions = stateQuestions;\n            storage.questions.store(stateQuestions);\n        }\n    }\n\n\n    private storeUsers(state: IAppState) {\n        const stateUsers = state.users.users;\n        if (stateUsers !== this.storedUsers) {\n            this.storedUsers = stateUsers;\n            storage.users.store(stateUsers);\n        }\n    }\n\n}\n","import React from 'react';\nimport { connect } from 'react-redux';\nimport './AppHeader.css';\nimport classnames from 'classnames';\nimport { app, ROUTE_STATES } from '../../app';\nimport * as screenfull from \"screenfull\";\nimport {Screenfull} from \"screenfull\";\nimport { IMapStateToProps } from '../../redux/connect';\n\n// https://github.com/sindresorhus/screenfull.js/issues/126#issuecomment-488796645\nlet sf = screenfull as Screenfull;\n\n\ninterface IAppHeaderProps {\n    className: string;\n    route?: ROUTE_STATES;\n    isFullScreen?: boolean;\n}\n\n\nconst mapStateToProps: IMapStateToProps<IAppHeaderProps, 'isFullScreen'> = (state) => ({\n    route: state.routing.route,\n    isFullScreen: state.fullScreen.inFullscreen\n});\n\n\nclass AppHeaderComponent extends React.Component<IAppHeaderProps> {\n\n    toggleState = () => app.toggleFullscreen();\n\n\n    render() {\n        const { className, isFullScreen, route } = this.props;\n        const mainRouteState = route === ROUTE_STATES.MAIN;\n        const conditionalClasses = {\n            'AppHeader_small': !mainRouteState\n        };\n\n        return (\n            <div className={classnames('AppHeader', className, conditionalClasses)}>\n                { !isFullScreen && mainRouteState && (\n                    <button type=\"button\" onClick={() => this.toggleFullScreen()} className=\"AppHeader__fullscreen\">\n                        Развернуть\n                    </button>\n                )}\n                { !mainRouteState && (\n                    <button type=\"button\" onClick={() => app.goToRoute(app.ROUTE_STATES.MAIN)}>\n                        На главную\n                    </button>\n                )}\n            </div>\n        );\n    }\n\n\n    componentDidMount() {\n        sf.on('change', this.toggleState);\n    }\n\n\n    componentWillUnmount() {\n        sf.off('change', this.toggleState);\n    }\n\n\n    toggleFullScreen() {\n        sf.toggle()\n            .catch(error => console.log(\n                `while toggling fullsreen state, current state is ${this.props.isFullScreen}`,\n                error\n            ));\n    }\n\n}\n\n\nexport const AppHeader = connect(mapStateToProps)(AppHeaderComponent);\n","import React from 'react';\nimport './Landing.css';\nimport { app } from '../../app';\n\n\ninterface ILandingProps {\n}\n\n\nconst LandingComponent: React.FC<ILandingProps> = () => {\n    return (\n        <div>\n            <div>\n                <button type=\"button\" onClick={() => app.restartGame()}>\n                    Начать\n                </button>\n            </div>\n            <div className=\"Landing__goToAdmin\">\n                <button type=\"button\" onClick={() => app.goToAdmin() }>\n                    Администрирование\n                </button>\n            </div>\n        </div>\n    );\n};\n\n\nexport const Landing = LandingComponent;\n","/**\n * Дополняет заданными символами слева до нужной длины строки.\n * @see https://developer.mozilla.org/ru/docs/Web/JavaScript/Reference/Global_Objects/String/padStart\n */\nexport function padStart(item: string|number, strLength: number, symbol: string): string {\n    const strItem = '' + item;\n    return strItem.padStart(strLength, symbol);\n}\n","import React from 'react';\nimport './FileExport.css';\nimport { IFileDescription, releaseFileObject, getFileObject, getFileName, FILE_TYPES } from '../../utils/file';\n\n\ninterface IFileExportProps {\n    getFileDescription: () => IFileDescription;\n    buttonText: string;\n}\n\n\ninterface IFileExportState {\n    fileObjectUrl: string;\n    fileName: string;\n}\n\n\nclass FileExportComponent extends React.Component<IFileExportProps, IFileExportState> {\n\n    state: IFileExportState = {\n        fileObjectUrl: '',\n        fileName: ''\n    };\n\n    render() {\n        const { buttonText } = this.props;\n        const { fileObjectUrl, fileName } = this.state;\n\n        return (\n            <div>\n                <button type=\"button\"\n                    onClick={() => this.prepareFile()}\n                    className=\"FileExport__button\"\n                >\n                    { buttonText }\n                </button>\n                { fileObjectUrl && (\n                    <a href={fileObjectUrl} download={fileName}\n                        className=\"FileExport__button\"\n                    >\n                        Скачать файл\n                    </a>\n                )}\n            </div>\n        );\n    }\n\n\n    private prepareFile() {\n        this.releaseStateFileObject();\n\n        const fileDescription = this.props.getFileDescription();\n        this.setState({\n            fileObjectUrl: getFileObject({\n                content: this.stringifyContent(fileDescription.content),\n                fileType: fileDescription.type\n            }),\n            fileName: getFileName(fileDescription.nameSection, FILE_TYPES[fileDescription.type].toLowerCase())\n        });\n    }\n\n\n    private releaseStateFileObject() {\n        const { fileObjectUrl } = this.state;\n        if (fileObjectUrl) {\n            releaseFileObject(fileObjectUrl);\n        }\n    }\n\n\n    private stringifyContent(content: any): string {\n        if (!content) {\n            return '';\n        }\n        if (typeof content === 'object') {\n            // readable json\n            return JSON.stringify(content, null, 4);\n        }\n        return JSON.stringify(content);\n    }\n\n};\n\n\nexport const FileExport = FileExportComponent;\n","import React, { ChangeEvent } from 'react';\nimport './FileImport.css';\nimport { readFileAsString } from '../../utils/file';\n\n\ninterface IFileImportProps {\n    buttonText: string;\n    onContentRead: (content: any) => void;\n    parseJson?: boolean;\n}\n\n\ninterface IFileImportState {\n}\n\n\nclass FileImportComponent extends React.Component<IFileImportProps, IFileImportState> {\n\n    state: IFileImportState = {\n    };\n\n    render() {\n        const { buttonText } = this.props;\n        return (\n            <label className=\"FileImport\">\n                { buttonText }\n                <input type=\"file\"\n                    className=\"FileImport_import\"\n                    onChange={(event) => this.onFileSelected(event)}\n                />\n            </label>\n        );\n    }\n\n\n    private onFileSelected(event: ChangeEvent<HTMLInputElement>) {\n        const files = event.target.files;\n        const file = files && files[0];\n        if (file) {\n            readFileAsString(file)\n                .then(content => {\n                    const { parseJson, onContentRead } = this.props;\n\n                    if (!parseJson) {\n                        return onContentRead(content);\n                    }\n\n                    const json = JSON.parse(content);\n                    onContentRead(json);\n                })\n                .catch(error => console.error(`while reading file ${file.name}`, error));\n        }\n    }\n\n};\n\n\nexport const FileImport = FileImportComponent;\n","import React from 'react';\nimport { connect } from 'react-redux';\nimport './AdminMenu.css';\nimport { app } from '../../app';\nimport { IQuestionsList } from '../../models/qa';\nimport { IExportedQuestions } from '../../models/export';\nimport { IMapStateToProps } from '../../redux/connect';\nimport { FileExport } from '../FileExport/FileExport';\nimport { FileImport } from '../FileImport/FileImport';\nimport { FILE_TYPES } from '../../utils/file';\nimport { IUser } from '../../models/user';\n\n\ninterface IAdminMenuProps {\n    questions?: IQuestionsList;\n    users?: IUser[];\n}\n\n\nconst mapStateToProps: IMapStateToProps<IAdminMenuProps, 'questions'> = (state) => ({\n    questions: state.questions.questions,\n    users: state.users.users,\n});\n\n\nconst AdminMenuComponent: React.FC<IAdminMenuProps> = ({ questions, users }) => {\n    return (\n        <ul className=\"AdminMenu__menu\">\n            <li>\n                <button type=\"button\" onClick={() => app.goToRoute(app.ROUTE_STATES.ADMIN_QUESTIONS_LIST)}>\n                    Управление вопросами\n                </button>\n            </li>\n            <li>\n                <FileImport buttonText=\"Прочитать вопросы из файла\"\n                    parseJson={true}\n                    onContentRead={(questions: IQuestionsList | IExportedQuestions) => {\n                        app.updateQuestions(questions);\n                        window.alert('Вопрос прочитаны успешно!');\n                    }}\n                />\n            </li>\n            <li>\n                <FileExport buttonText=\"Скачать вопросы\"\n                    getFileDescription={() => ({\n                        type: FILE_TYPES.JSON,\n                        content: { questions },\n                        nameSection: 'questions'\n                    })}\n                />\n            </li>\n            <li>\n                <FileExport buttonText=\"Выгрузить пользователей\"\n                    getFileDescription={() => ({\n                        type: FILE_TYPES.JSON,\n                        content: { users },\n                        nameSection: 'users'\n                    })}\n                />\n            </li>\n            <li>\n                <button type=\"button\" onClick={() => app.goToRoute(app.ROUTE_STATES.MAIN)}>\n                    На главную\n                </button>\n            </li>\n        </ul>\n    );\n};\n\n\nexport const AdminMenu = connect(mapStateToProps)(AdminMenuComponent);\n","export type IPlaceholders = '<%reg%>' | '<%login%>';\n\nexport const placeholdersInfo: { [key in IPlaceholders]: string} = {\n    '<%reg%>': 'поля для ввода регистрационных данных (только для вопросов)',\n    '<%login%>': 'вывод логина или \"Пользователь\" (по умолчанию)',\n};\n\nexport const placeholderReg: IPlaceholders = '<%reg%>';\nexport const placeholderLogin: IPlaceholders = '<%login%>';\n","import * as React from 'react';\nimport { IQuestion, IAnswer, IQuestionsList } from '../../models/qa';\nimport './QuestionEdit.css';\nimport classnames from 'classnames';\nimport { cloneQuestion } from '../../utils/clone-question';\nimport { placeholderReg } from '../../models/placeholders';\n\n\ninterface IQuestionEditProps {\n    question?: IQuestion;\n    qs: IQuestionsList;\n    onSave: (question: IQuestion) => void;\n    onDelete?: (question: IQuestion) => void;\n    className?: string;\n}\n\n\ninterface IQuestionEditState {\n    question?: IQuestion;\n    isNew: boolean;\n    hideTextError: boolean;\n}\n\n\nfunction getNewQuestion(): IQuestion {\n    return {\n        id: 0,\n        text: '',\n        // title: '',\n        answers: []\n    }\n}\n\n\nexport class QuestionEdit extends React.Component<IQuestionEditProps, IQuestionEditState> {\n\n    state: IQuestionEditState = {\n        isNew: true,\n        hideTextError: false,\n    };\n\n\n    static getDerivedStateFromProps(props: IQuestionEditProps, state: IQuestionEditState): IQuestionEditState | null {\n        const propQuestion = props.question;\n        const stateQuestion = state.question;\n\n        if (propQuestion) {\n            if (stateQuestion && stateQuestion.id === propQuestion.id) {\n                // update isFirst\n                return {\n                isNew: false,\n                hideTextError: false,\n                question: {\n                    ...stateQuestion,\n                    isFirst: propQuestion.isFirst\n                }\n                }\n            } else {\n                return {\n                isNew: false,\n                hideTextError: false,\n                question: cloneQuestion(propQuestion)\n                };\n            }\n        } else if (stateQuestion) {\n            return null;\n        }\n\n        return {\n            isNew: true,\n            hideTextError: true,\n            question: getNewQuestion()\n        };\n    }\n\n\n    render() {\n        const { question, isNew, hideTextError } = this.state;\n        const { qs, className } = this.props;\n        const hasAnswers = question!.answers.filter(Boolean).length > 0;\n        const isFinal = !hasAnswers;\n        const tooManyReg = question!.text.split(placeholderReg).length > 2;\n\n        const mainHtmlId = `QuestionEdit__${question!.id}`;\n        // const titleHtmlId = `${mainHtmlId}__title`;\n        const textHtmlId = `${mainHtmlId}__text`;\n        const isFirstHtmlId = `${mainHtmlId}__isFirst`;\n        const randomTextHtmlId = `${mainHtmlId}__randomText`;\n\n        const rootId = this.getRootId(this.props.question ? this.props.question.id : 0);\n\n        return (\n            <div className={classnames('QuestionEdit', className)} id={rootId}>\n                <form onSubmit={(event) => this.onSubmit(question!, event)}>\n                    <div className={classnames('QuestionEdit__indented', 'QuestionEdit__row')}>\n                        <b>\n                            {isNew\n                                ? 'Новый вопрос'\n                                : isFinal\n                                    ? `Финал, #${question!.id}`\n                                    : `Вопрос, #${question!.id}`\n                            }\n                        </b>\n                        {!isFinal && (\n                            <div className={classnames('QuestionEdit__wideItem', 'QuestionEdit__checkboxContainer')}>\n                                <label>\n                                    <input type=\"checkbox\"\n                                        name={isFirstHtmlId}\n                                        checked={question!.isFirst}\n                                        onChange={(event) => this.updateQuestionProp('isFirst', event.target.checked)}\n                                        className=\"QuestionEdit__checkbox\"\n                                    />\n                                    первый вопрос\n                                </label>\n                            </div>\n                        )}\n                    </div>\n                    {/* <div className={classnames('QuestionEdit__row', 'QuestionEdit__indented')}>\n                        <label htmlFor={titleHtmlId}>\n                            Заголовок\n                        </label>\n                        <input name={titleHtmlId}\n                            type=\"text\"\n                            id={titleHtmlId}\n                            value={question!.title}\n                            onChange={(event) => this.updateQuestionProp('title', event.target.value)}\n                            className=\"QuestionEdit__wideItem\"\n                            placeholder=\"Необязательно\"\n                        />\n                    </div> */}\n                    <div className={classnames('QuestionEdit__row', 'QuestionEdit__indented')}>\n                        <label htmlFor={textHtmlId}>\n                            Текст\n                        </label>\n                        <div className=\"QuestionEdit__wideItem\">\n                            <textarea name={textHtmlId}\n                                id={textHtmlId}\n                                className={classnames('', 'QuestionEdit__bigEditor')}\n                                value={question!.text}\n                                onChange={(event) => this.updateQuestionProp('text', event.target.value)}\n                                placeholder=\"Заполните текст вопроса!\"\n                            ></textarea>\n                            <div className=\"QuestionEdit__checkboxContainer\">\n                                <label>\n                                    <input type=\"checkbox\"\n                                        name={randomTextHtmlId}\n                                        checked={!!question!.randomLineText}\n                                        onChange={(event) => this.updateQuestionProp('randomLineText', event.target.checked)}\n                                        className=\"QuestionEdit__checkbox\"\n                                    />\n                                    показывать рандомную строку\n                                </label>\n                            </div>\n                            { question!.randomLineText && (\n                                <div>\n                                    ВНИМАНИЕ: пользователю будет отображаться рандомная непустая строка из текста этого вопроса!!!\n                                </div>\n                            )}\n                            { tooManyReg && (\n                                <div className=\"QuestionEdit__error\">\n                                    Вы вставили больше одного блока ввода регистрационных данных!\n                                </div>\n                            )}\n                        </div>\n                    </div>\n\n                    {\n                        !question!.text && !hideTextError && (\n                            <div className={classnames('QuestionEdit__indented', 'QuestionEdit__error')}>\n                                Заполните текст вопроса!\n                            </div>\n                        )\n                    }\n\n                    {\n                        hasAnswers && (\n                            <div className={'QuestionEdit__indented'}>\n                                Ответы:\n                            </div>\n                        )\n                    }\n\n                    {\n                        question!.answers.map((answerOrNull, index) => {\n                            if (!answerOrNull) {\n                                return null;\n                            }\n\n                            const answer = answerOrNull!;\n                            const answerHtmlId = `${mainHtmlId}_answer_${answer.id}`;\n                            const answerGotoHtmlId = `${answerHtmlId}_goto`;\n                            const answerInputHtmlId = `${answerHtmlId}_input`;\n                            const answerWrongInputGotoHtmlId = `${answerHtmlId}_wrongInputGot`;\n                            const answerRandomLineHtmlId = `${answerHtmlId}_randomLine`;\n\n                            return (\n                                <div className={'QuestionEdit__indented'} key={answer.id}>\n                                    <div className={classnames('QuestionEdit__row', 'QuestionEdit__indented')} key={`${answer.id}_text`}>\n                                        <textarea\n                                            name={answerHtmlId}\n                                            id={answerHtmlId}\n                                            value={answer.text}\n                                            onChange={(event) => this.updateAnswerProp(answer, 'text', event.target.value)}\n                                            className={classnames('QuestionEdit__wideItem', 'QuestionEdit__bigEditor')}\n                                            placeholder=\"Заполните текст ответа!!!\"\n                                        ></textarea>\n                                        <button type=\"button\" onClick={() => this.deleteAnswer(index)}>\n                                            Удалить\n                                        </button>\n                                    </div>\n                                    {\n                                        !answer.text && (\n                                            <div className={classnames('QuestionEdit__indented', 'QuestionEdit__error')}>\n                                                Заполните текст ответа!!!\n                                            </div>\n                                        )\n                                    }\n                                    <div className={classnames('QuestionEdit__row', 'QuestionEdit__indented', 'QuestionEdit__hor-indented', 'QuestionEdit__checkboxContainer')}\n                                        key={`${answer.id}_randomLine`}\n                                    >\n                                        <label>\n                                            <input type=\"checkbox\"\n                                                name={answerRandomLineHtmlId}\n                                                checked={answer.randomLine}\n                                                onChange={(event) => this.updateAnswerProp(answer, 'randomLine', event.target.checked)}\n                                                className=\"QuestionEdit__checkbox\"\n                                            />\n                                            показывать произвольную строчку\n                                        </label>\n                                    </div>\n                                    <div className={classnames('QuestionEdit__row', 'QuestionEdit__indented', 'QuestionEdit__hor-indented', 'QuestionEdit__checkboxContainer')}\n                                        key={`${answer.id}_userInput`}\n                                    >\n                                        <label>\n                                            <input type=\"checkbox\"\n                                                name={answerInputHtmlId}\n                                                checked={answer.needUserInput}\n                                                onChange={(event) => this.updateAnswerProp(answer, 'needUserInput', event.target.checked)}\n                                                className=\"QuestionEdit__checkbox\"\n                                            />\n                                            пользовательский ввод\n                                        </label>\n                                    </div>\n                                    { answer.needUserInput && (\n                                        <div className={classnames('QuestionEdit__row', 'QuestionEdit__hor-indented')} key={`${answer.id}_wrongInputGoto`}>\n                                            <label htmlFor={answerWrongInputGotoHtmlId}>\n                                                Ошибка на\n                                            </label>\n                                            <div className={'QuestionEdit__wideItem'}>\n                                                <select id={answerWrongInputGotoHtmlId}\n                                                    value={answer.incorrectUserInputNextQuestion}\n                                                    name={answerWrongInputGotoHtmlId}\n                                                    onChange={(event) => this.updateAnswerProp(answer, 'incorrectUserInputNextQuestion', parseInt(event.target.value, 10))}\n                                                >\n                                                    {!answer.incorrectUserInputNextQuestion && (\n                                                        <option value=\"0\">\n                                                            Выберите точку перехода при неверном вводе\n                                                        </option>\n                                                    )}\n                                                    {\n                                                        qs.map(question => question && (\n                                                            <option key={question.id} value={question.id}>\n                                                                {/* {question.title || question.text} */}\n                                                                { question.text }\n                                                            </option>\n                                                        ))\n                                                    }\n                                                </select>\n                                                <div>\n                                                    <a href={`#${this.getRootId(answer.incorrectUserInputNextQuestion)}`}>\n                                                        {answer.incorrectUserInputNextQuestion ? 'к вопросу' : 'создать новый'}\n                                                    </a>\n                                                </div>\n                                                {\n                                                    !answer.incorrectUserInputNextQuestion && (\n                                                        <div className=\"QuestionEdit__error\">\n                                                            Выберите точку перехода!!!\n                                                        </div>\n                                                    )\n                                                }\n                                            </div>\n                                        </div>\n                                    )}\n                                    <div className={classnames('QuestionEdit__row', 'QuestionEdit__hor-indented')} key={`${answer.id}_goto`}>\n                                        <label htmlFor={answerGotoHtmlId}>\n                                            Перейти к\n                                        </label>\n                                        <div className={'QuestionEdit__wideItem'}>\n                                            <select id={answerGotoHtmlId}\n                                                value={answer.nextQuestion}\n                                                name={answerGotoHtmlId}\n                                                onChange={(event) => this.updateAnswerProp(answer, 'nextQuestion', parseInt(event.target.value, 10))}\n                                            >\n                                                {!answer.nextQuestion && (\n                                                    <option value=\"0\">\n                                                        Выберите точку перехода!!!\n                                                    </option>\n                                                )}\n                                                {\n                                                    qs.map(question => question && (\n                                                        <option key={question.id} value={question.id}>\n                                                            {/* {question.title || question.text} */}\n                                                            { question.text }\n                                                        </option>\n                                                    ))\n                                                }\n                                            </select>\n                                            <div>\n                                                <a href={`#${this.getRootId(answer.nextQuestion)}`}>\n                                                    {answer.nextQuestion ? 'к вопросу' : 'создать новый'}\n                                                </a>\n                                            </div>\n                                            {\n                                                !answer.nextQuestion && (\n                                                    <div className=\"QuestionEdit__error\">\n                                                        Выберите точку перехода!!!\n                                                    </div>\n                                                )\n                                            }\n                                        </div>\n                                    </div>\n                                </div>\n                            );\n                        })\n                    }\n\n                    <div className={'QuestionEdit__indented'}>\n                        <button type=\"button\" onClick={() => this.addAnswer()}>\n                            Добавить ответ\n                        </button>\n                    </div>\n\n                    <div className={'QuestionEdit__indented'}>\n                        {isNew && (\n                            <button type=\"submit\" className={'QuestionEdit__submit'}>\n                                Добавить этот вопрос\n                            </button>\n                        )}\n                        {\n                            this.props.onDelete && (\n                                <button type=\"button\" className={'QuestionEdit__delete'} onClick={() => this.props.onDelete!(question!)}>\n                                    Удалить вопрос\n                                </button>\n                            )\n                        }\n                    </div>\n                </form>\n            </div>\n        );\n    }\n\n\n    private updateQuestionProp<K extends keyof IQuestion>(propName: K, propValue: IQuestion[K]) {\n        const question = { ...this.state.question, [propName]: propValue } as IQuestion;\n        this.setState({\n            question,\n            hideTextError: false\n        });\n\n        if (!this.state.isNew) {\n            this.onSubmit(question);\n        }\n    }\n\n\n    private updateAnswerProp<K extends keyof IAnswer>(originalAnswer: IAnswer, propName: K, propValue: IAnswer[K]) {\n        const updatedAnswer = { ...originalAnswer, [propName]: propValue } as IAnswer;\n        const answers = this.state.question!.answers.map(answer => answer && answer.id === originalAnswer.id ? updatedAnswer : answer);\n        this.updateQuestionProp('answers', answers);\n    }\n\n\n    private onSubmit(question: IQuestion, event?: React.BaseSyntheticEvent) {\n        if (event) {\n            event.preventDefault();\n        }\n\n        if (!question.text) {\n            return;\n        }\n\n        if (this.state.isNew) {\n            if (event) {\n                this.props.onSave(question);\n                this.setState({\n                    hideTextError: true,\n                    question: getNewQuestion()\n                });\n            }\n        } else {\n            this.props.onSave(question);\n        }\n    }\n\n\n    private deleteAnswer(answerIndex: number) {\n        const answers = this.state.question!.answers.map((answer, index) => !answer || index === answerIndex ? null : answer);\n        this.updateQuestionProp('answers', answers);\n    }\n\n\n    private addAnswer() {\n        const stateAnswers = this.state.question!.answers;\n        const newAnswer: IAnswer = {\n            id: stateAnswers.length + 1,\n            text: '',\n            nextQuestion: 0,\n        };\n        const answers = [...stateAnswers, newAnswer];\n        this.updateQuestionProp('answers', answers);\n    }\n\n\n    private getRootId(questionId?: number): string {\n        const baseId = 'QuestionEdit_root_';\n        return questionId ? `${baseId}_${questionId}` : `${baseId}_new`;\n    }\n\n}\n","import { IQuestion } from '../models/qa';\n\nexport function cloneQuestion(question: IQuestion): IQuestion {\n    return {\n      ...question,\n      answers: question.answers.map(answer => answer ? { ...answer } : null)\n    };\n  }\n","import React from 'react';\nimport { connect } from 'react-redux';\nimport { IMapStateToProps } from '../../redux/connect';\nimport './QuestionsManagement.css';\nimport { app } from '../../app';\nimport { QuestionEdit } from '../QuestionEdit/QuestionEdit';\nimport { IQuestionsList } from '../../models/qa';\nimport { placeholdersInfo, IPlaceholders } from '../../models/placeholders';\n\n\ninterface IQuestionsManagementProps {\n    questions?: IQuestionsList;\n}\n\n\nconst mapStateToProps: IMapStateToProps<IQuestionsManagementProps, 'questions'> = (state) => ({\n    questions: state.questions.questions\n});\n\n\nconst QuestionsManagementComponent: React.FC<IQuestionsManagementProps> = (props) => {\n    const qs = props.questions!;\n\n    return (\n        <div>\n            <div>\n                Задайте вопросы квеста!\n                <br />\n                Вопросы без ответов считаются финальными состояними квеста!\n                <br />\n                Ответы без текста или без указания цели перехода отображены не будут!\n                <br />\n                При удалении вопросов или ответов номера остальных вопросов/ответов не меняются!\n            </div>\n            <div>\n                В тексте вопросов и ответов можно использовать подстановки:\n                {\n                    Object.keys(placeholdersInfo).map((placeholder, index) => (\n                        <div key={index}>\n                            { placeholder } - { placeholdersInfo[placeholder as IPlaceholders] }\n                        </div>\n                    ))\n                }\n            </div>\n\n            <QuestionEdit\n                className=\"QuestionsManagement__question\"\n                onSave={(question) => app.addQuestion(question)}\n                qs={qs}\n            />\n\n            {\n                qs.map(question => question && (\n                    <QuestionEdit\n                        className=\"QuestionsManagement__question\"\n                        question={question}\n                        key={question.id}\n                        onSave={(question) => app.updateQuestion(question)}\n                        onDelete={(question) => app.deleteQuestion(question)}\n                        qs={qs}\n                    />\n                ))\n            }\n\n            <div className=\"QuestionsManagement__link-container\">\n                <button type=\"button\"\n                    onClick={() => app.goToRoute(app.ROUTE_STATES.MAIN)}\n                >\n                    На главную\n                </button>\n            </div>\n\n        </div>\n    );\n\n};\n\n\nexport const QuestionsManagement = connect(mapStateToProps)(QuestionsManagementComponent);\n","import React from 'react';\nimport { connect } from 'react-redux';\nimport { IMapStateToProps } from '../../redux/connect';\nimport { app } from '../../app';\nimport { IUser } from '../../models/user';\nimport './RegistrationForm.css';\nimport { getNewUser } from '../../utils/get-new-user';\n\n\ninterface IRegistrationFormProps {\n    route: string;\n    className?: string;\n}\n\n\ninterface IRegistrationFormState {\n    user: IUser;\n}\n\n\nconst mapStateToProps: IMapStateToProps<IRegistrationFormProps, 'route'> = (state) => ({\n    route: state.routing.route\n});\n\n\nclass RegistrationFormComponent extends React.Component<IRegistrationFormProps, IRegistrationFormState> {\n\n    state = {\n        user: getNewUser()\n    };\n\n    render() {\n        const mainId = `RegistrationForm`;\n        const firstNameId = `${mainId}_fn`;\n        const lastNameId = `${mainId}_ln`;\n        const phoneId = `${mainId}_phone`;\n        const loginId = `${mainId}_login`;\n\n        return (\n            <ul className={this.props.className}>\n                <li>\n                    <label htmlFor={firstNameId} className=\"RegistrationForm__label\">\n                        Имя:\n                    </label>\n                    <input type=\"text\"\n                        className=\"std\"\n                        id={firstNameId}\n                        name={firstNameId}\n                        maxLength={100}\n                        value={this.state.user.firstName}\n                        onChange={(event) => this.updateUser('firstName', event)}\n                    />\n                </li>\n                <li>\n                    <label htmlFor={lastNameId} className=\"RegistrationForm__label\">\n                        Фамилия:\n                    </label>\n                    <input type=\"text\"\n                        className=\"std\"\n                        id={lastNameId}\n                        name={lastNameId}\n                        maxLength={100}\n                        value={this.state.user.lastName}\n                        onChange={(event) => this.updateUser('lastName', event)}\n                    />\n                </li>\n                <li>\n                    <label htmlFor={phoneId} className=\"RegistrationForm__label\">\n                        Телефон:\n                    </label>\n                    <input type=\"text\"\n                        className=\"std\"\n                        id={phoneId}\n                        name={phoneId}\n                        maxLength={100}\n                        value={this.state.user.phone}\n                        onChange={(event) => this.updateUser('phone', event)}\n                    />\n                </li>\n                <li>\n                    <label htmlFor={loginId} className=\"RegistrationForm__label\">\n                        Логин:\n                    </label>\n                    <input type=\"text\"\n                        className=\"std\"\n                        id={loginId}\n                        name={loginId}\n                        maxLength={100}\n                        value={this.state.user.login}\n                        onChange={(event) => this.updateUser('login', event)}\n                    />\n                </li>\n            </ul>\n        );\n    }\n\n\n    private updateUser(userProp: keyof IUser, event: React.ChangeEvent<HTMLInputElement>) {\n        const value = event.target.value;\n        const user = { ...this.state.user, [userProp]: value };\n        this.setState({ user });\n        app.registerUser(user);\n    }\n\n}\n\n\nexport const RegistrationForm = connect(mapStateToProps)(RegistrationFormComponent);\n","import { IUser } from '../models/user';\n\nexport function getNewUser(): IUser {\n    return {\n        firstName: '',\n        lastName: '',\n        login: '',\n        phone: '',\n        lastQuestionId: 0\n    };\n}\n","import React from 'react';\nimport { connect } from 'react-redux';\nimport { IMapStateToProps } from '../../redux/connect';\nimport './Quest.css';\nimport { app } from '../../app';\nimport { IQuestion, IQuestionsList, IAnswer } from '../../models/qa';\nimport classnames from 'classnames';\nimport { placeholderReg, placeholderLogin } from '../../models/placeholders';\nimport { RegistrationForm } from '../RegistrationForm/RegistrationForm';\nimport { IUser } from '../../models/user';\n\n\ninterface IQuestProp {\n    questions?: IQuestionsList;\n    currentQuestionId?: number;\n    registrationUser?: IUser | null;\n}\n\n\ninterface IQuestState {\n    userInput: string;\n    currentQuestionId: number;\n}\n\n\nconst mapStateToProps: IMapStateToProps<IQuestProp, 'questions' | 'currentQuestionId'> = (state) => ({\n    questions: state.questions.questions,\n    currentQuestionId: state.questions.currentQuestionId,\n    registrationUser: state.users.registrationUser,\n});\n\n\nclass QuestComponent extends React.Component<IQuestProp, IQuestState> {\n\n    state: IQuestState = {\n        userInput: '',\n        currentQuestionId: 0\n    };\n\n\n    static getDerivedStateFromProps(props: IQuestProp, state: IQuestState): IQuestState | null {\n        if (props.currentQuestionId && props.currentQuestionId !== state.currentQuestionId) {\n            return { ...state, userInput: '' };\n        }\n        return null;\n    }\n\n\n    render() {\n\n        const currentQuestionId = this.props.currentQuestionId!;\n        const questions = this.props.questions!;\n        const regUser = this.props.registrationUser;\n\n        let currentQuestion: IQuestion|undefined|null;\n        if (!currentQuestionId) {\n            currentQuestion = questions!.filter(question => question ? question.isFirst : false)[0];\n        } else {\n            currentQuestion = questions!.filter(question => question ? question.id === currentQuestionId : false)[0];\n        }\n\n        if (!currentQuestion) {\n            return (\n                <h1>Первый вопрос не выбран или следующий вопрос \"{currentQuestionId}\" не найден!</h1>\n            );\n        }\n\n        const isFinal = currentQuestion.answers.filter(Boolean).length === 0;\n        const hasReg = currentQuestion.text.includes(placeholderReg);\n        const hideAnswers = hasReg && (!regUser || !regUser.phone\n            || (!regUser.firstName && !regUser.lastName) || !regUser.login);\n\n        return (\n            <div>\n                {/* {currentQuestion.title && (\n                    <div className=\"Quest__title\">\n                        {currentQuestion.title}\n                    </div>\n                )} */}\n                <div className={classnames('Quest__text', 'Quest__ml')}>\n                    { this.renderQuestionText(currentQuestion) }\n                </div>\n                {!isFinal && !hideAnswers && (\n                    <ul className=\"Quest__answers\">\n                        {\n                            currentQuestion.answers.map(answer => {\n                                if (!answer || !answer.text || !answer.nextQuestion) {\n                                    return null;\n                                }\n\n                                return (\n                                    <li key={answer.id} className=\"Quest__action-container\">\n                                        { this.renderAnswer(answer) }\n                                    </li>\n                                );\n                            })\n                        }\n                    </ul>\n                )}\n                {isFinal && (\n                    <ul className=\"Quest__final-actions\">\n                        <li>\n                            <button type=\"button\"\n                                onClick={() => app.restartGame()}\n                            >\n                                Попробовать снова\n                            </button>\n                        </li>\n                        <li>\n                            <button type=\"button\"\n                                onClick={() => app.goToRoute(app.ROUTE_STATES.MAIN)}\n                            >\n                                Дать поиграть другим\n                            </button>\n                        </li>\n                    </ul>\n                )}\n            </div>\n        );\n    }\n\n\n    private renderAnswer(answer: IAnswer): React.ReactElement {\n        if (answer.needUserInput) {\n            return (\n                <div className=\"Quest__user-input-container\">\n                    <input type=\"text\"\n                        maxLength={100}\n                        value={this.state.userInput}\n                        onChange={(event) => this.setState({ userInput: event.target.value }) }\n                        className=\"std\"\n                        placeholder=\"Введите ответ здесь\"\n                    />\n                    { this.state.userInput && (\n                        <button type=\"button\"\n                            className=\"Quest__user-input-submit\"\n                            onClick={() => this.handleSelectedAnswer(answer)}\n                        >\n                            Отправить ответ\n                        </button>\n                    )}\n                </div>\n            );\n        }\n\n        let text = answer.text;\n        if (answer.randomLine) {\n            const texts = text.split('\\n');\n            const randomTextIndex = Math.floor(Math.random() * texts.length);\n            text = texts[randomTextIndex];\n        }\n\n        return (\n            <button type=\"button\" onClick={() => this.handleSelectedAnswer(answer)}\n                className={classnames('Quest__action', 'Quest__ml')}\n            >\n                { this.replaceLogin(text) }\n            </button>\n        );\n    }\n\n\n    private handleSelectedAnswer(answer: IAnswer) {\n        let nextQuestion: number | undefined = answer.nextQuestion;\n\n        if (answer.needUserInput) {\n            const expectedValue = answer.text.toLowerCase().trim();\n            const inputValue = this.state.userInput.toLowerCase().trim();\n            nextQuestion = inputValue === expectedValue\n                ? answer.nextQuestion\n                : answer.incorrectUserInputNextQuestion;\n        }\n\n        app.nextQuestion(nextQuestion || 0);\n    }\n\n\n    private renderQuestionText(question: IQuestion): React.ReactElement | string | Array<React.ReactElement | string> {\n        if (question.randomLineText) {\n            const texts = question.text.split('\\n').filter(Boolean);\n            const randomTextIndex = Math.floor(Math.random() * texts.length);\n            const text = texts[randomTextIndex];\n            return this.replaceLogin(text);\n        }\n\n        if (question.text.includes(placeholderReg)) {\n            const textParts = question.text.split(placeholderReg);\n            return [\n                this.replaceLogin(textParts[0].trim()),\n                <RegistrationForm key={1} className=\"Quest__registration\"/>,\n                this.replaceLogin(textParts[1].trim()),\n            ];\n        }\n\n        return this.replaceLogin(question.text);\n    }\n\n\n    private replaceLogin(text: string): string {\n        if (!text.includes(placeholderLogin)) {\n            return text;\n        }\n        const login = this.props.registrationUser && this.props.registrationUser.login || 'Пользователь';\n        return text.split(placeholderLogin).join(login);\n    }\n\n};\n\n\nexport const Quest = connect(mapStateToProps)(QuestComponent);\n","import React from 'react';\nimport { connect } from 'react-redux';\nimport { IMapStateToProps } from '../../redux/connect';\nimport { app, ROUTE_STATES } from '../../app';\nimport { Landing } from '../Landing/Landing';\nimport { AdminMenu } from '../AdminMenu/AdminMenu';\nimport { QuestionsManagement } from '../QuestionsManagement/QuestionsManagement';\nimport { Quest } from '../Quest/Quest';\n\n\ninterface IRoutingProps {\n    route?: ROUTE_STATES\n}\n\n\nconst mapStateToProps: IMapStateToProps<IRoutingProps, 'route'> = (state) => ({\n    route: state.routing.route\n});\n\n\nconst RoutingComponent: React.FC<IRoutingProps> = ({ route }) => {\n    switch (route) {\n        case app.ROUTE_STATES.QUEST:\n            return <Quest/>\n        case app.ROUTE_STATES.ADMIN_QUESTIONS_LIST:\n            return <QuestionsManagement/>;\n        case app.ROUTE_STATES.ADMIN_MAIN:\n            return <AdminMenu/>;\n        case app.ROUTE_STATES.MAIN:\n        default:\n            return <Landing/>;\n    }\n};\n\n\nexport const Routing = connect(mapStateToProps)(RoutingComponent);\n","import React from 'react';\nimport { connect } from 'react-redux';\nimport './App.css';\nimport { AppHeader } from '../AppHeader/AppHeader';\nimport { IMapStateToProps } from '../../redux/connect';\nimport { Routing } from './../Routing/Routing';\nimport { ROUTE_STATES } from '../../app';\nimport classnames from 'classnames';\n\n\ninterface IAppProps {\n    route?: ROUTE_STATES,\n}\n\n\nconst mapStateToProps: IMapStateToProps<IAppProps, 'route'> = (state) => ({\n    route: state.routing.route,\n});\n\n\nconst AppComponent: React.FC<IAppProps> = ({ route }) => {\n    const conditionalClasses = {\n        '_header_small': route !== ROUTE_STATES.MAIN,\n        '_quest-in-progress': route === ROUTE_STATES.QUEST,\n    };\n\n    return (\n        <div className={classnames('App', conditionalClasses)}>\n            <div className=\"App__container\">\n                <AppHeader className=\"App__header\"/>\n                <Routing/>\n            </div>\n        </div>\n    );\n};\n\n\nexport const App = connect(mapStateToProps)(AppComponent);\n","import { combineReducers } from 'redux';\nimport { IAppState } from './state';\nimport { fullScreenReducer } from './full-screen/full-screen-reducer';\nimport { routingReducer } from './routing/routing-reducer';\nimport { questionsReducer } from './questions/questions-reducer';\nimport { usersReducer } from './users/users-reducer';\n\n\nexport const rootReducer = combineReducers<IAppState>({\n    fullScreen: fullScreenReducer,\n    routing: routingReducer,\n    questions: questionsReducer,\n    users: usersReducer,\n});\n","import { fullScreenInitialState, IFullScreenState } from './full-screen/full-screen-state';\nimport { routeInitialState, IRoutingState } from './routing/routing-state';\nimport { questionsInitialState, IQuestionsState } from './questions/questions-state';\nimport { usersInitialState, IUsersState } from './users/users-state';\n\n\nexport interface IAppState {\n    fullScreen: IFullScreenState,\n    routing: IRoutingState,\n    questions: IQuestionsState,\n    users: IUsersState,\n};\n\n\nexport const initialState: IAppState = {\n    fullScreen: fullScreenInitialState,\n    routing: routeInitialState,\n    questions: questionsInitialState,\n    users: usersInitialState,\n};\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport { App } from './components/App/App';\nimport { Provider } from 'react-redux'\nimport { configureStore, IAppStore } from './redux/store';\nimport { app } from './app';\n\nconst store = configureStore() as IAppStore;\n\napp.setStore(store);\n\nconst appElement = (\n    <Provider store={store}>\n        <App/>\n    </Provider>\n);\n\ndocument.title = 'OK Mobius 2019';\n\nReactDOM.render(appElement, document.getElementById('root'));\n","import { createStore, Store, Action } from 'redux';\nimport { rootReducer } from './root-reducer';\nimport { initialState, IAppState } from './state';\n\n\nexport interface IAction<TPayload> extends Action<string> {\n    payload: TPayload;\n}\n\n\n// any type does not matter this case\nexport type IAppStore = Store<IAppState, IAction<any>>;\n\n\nexport function configureStore() {\n  return createStore(rootReducer, initialState);\n}\n"],"sourceRoot":""}